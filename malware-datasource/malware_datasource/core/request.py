import requests
import pyzipper
import pandas as pd
import sys
import os
import re
import shutil

MALWARE_BAZAAR = 'malware_bazaar'
URL_HAUS = 'url_haus'

MALWARE_BAZAAR_API_BASE_URL = 'https://mb-api.abuse.ch/api/v1/'
MALWARE_BAZAAR_DOWNLOAD_ROOT_PATH = 'https://datalake.abuse.ch/malware-bazaar/daily'

URL_HAUS_API_BASE_URL = 'https://urlhaus-api.abuse.ch/v1/payload/'
URL_HAUS_DOWNLOAD_ROOT_PATH = 'https://datalake.abuse.ch/urlhaus/daily/'

ZIP_PASSWORD = b'infected'

TEMPORARY_DIRECTORY = './tmp'

def download_file(file_url, output_filepath):
    response = requests.get(file_url)
    with open(output_filepath, 'wb') as f:
        f.write(response.content)
