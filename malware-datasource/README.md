# Malware Datasource

Program developed to enable easy download and manipulation of publicly distributed malwares available by trusted sources.

Any source with daily batches feature can be used using this program. More than that, it can be used to manipulate downloaded samples in a proper way.

## Available Sources

- [Malware Bazaar (Default)](https://bazaar.abuse.ch/)
- [URL Haus](https://urlhaus.abuse.ch/)

## Features

The main executable from the malware_datasource module is `generate_datasource`, it provides the main functionalities written. Between those are:

**Samples download**

Using some sources daily batches features, the main script can allow you to download any number of samples you want.

**Export dataset**

Since the script can allow you to download innumerable amounts of samples, it is very useful to have the hability to generate a single dataset containing each files information. 

**Extract dynamic functions**

One kind of information used by NASTYWARE Driver is the binary dynamic functions. The script `generate_datasouce` provides a great feature to make it easy to export that information into the `imports` directory.

**Easy to add new sources**

This project uses daily batches features to download samples. You can add newer sources by changing `malware_sources.json` file and creating a new class with respective functions to download samples and request information.

For each of those features, access the "Examples" section to know more

## Examples

Most of those flags can be combined to execute it all in the same run.

Besides that, all the flags can be found using `./generate_datasource.py --help`

**Samples download**

Using Malware Bazaar daily bacthes

```
./generate_datasource.py --download --from_date 2020-03-24 --to_date 2020-03-25 --source malware_bazaar
```

Knowing that Malware Bazaar is the default source, the following command will produce the same result

```
./generate_datasource.py --download --from_date 2020-03-24 --to_date 2020-03-25
```

Using URL Haus daily bacthes

```
./generate_datasource.py --download --from_date 2020-03-24 --to_date 2020-03-25 --source url_haus
```


**Export dataset**

After having some samples in the `./samples/` directory, you can generate the dataset using:

```
./generate_datasource.py --export_dataset
```

**Extract dynamic functions**

## To Do
- [ ] Melhorar interface
    - [ ] Tirar a execucao do damicore do malware-datasource
    - [ ] ...

- [X] Melhorar modularidade
    - [X] Criar classes para DataSources
    - [X] Criar classes dataset
    - [X] Permitir que malware_source seja s√≥ adicionado pelo json
    - [X] Mover constantes para um arquivo separado


- [X] Padronizar dataset criado

- [ ] Preencher Sessoes do README