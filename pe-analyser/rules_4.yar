drvnskm_rule rule_cluster_0{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('kernel32.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW')) and (not(pe.imports('kernel32.dll', 'DecodePointer')) and not(pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer')) and not(pe.imports('rtmpal.dll', 'DecodePointer')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer')) and not(pe.imports('kernelbase.dll', 'DecodePointer'))) and (not(pe.imports('kernel32.dll', 'SetCurrentDirectoryW')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'SetCurrentDirectoryW')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'SetCurrentDirectoryW'))))} drvnskm_rule rule_cluster_1{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('kernel32.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW'))) and (not(pe.imports('user32.dll', 'InvalidateRect'))) and (not(pe.imports('kernel32.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW'))))} drvnskm_rule rule_cluster_2{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (pe.imports('kernel32.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('kernelbase.dll', 'QueryPerformanceCounter') or pe.imports('rtmpal.dll', 'QueryPerformanceCounter')) and (not(pe.imports('user32.dll', 'MessageBoxA'))) and (pe.imports('user32.dll', 'SetMenuDefaultItem')))} drvnskm_rule rule_cluster_2{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (pe.imports('kernel32.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('kernelbase.dll', 'QueryPerformanceCounter') or pe.imports('rtmpal.dll', 'QueryPerformanceCounter')) and (not(pe.imports('user32.dll', 'MessageBoxA'))) and (pe.imports('user32.dll', 'SetMenuDefaultItem'))) or ((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (pe.imports('kernel32.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('kernelbase.dll', 'QueryPerformanceCounter') or pe.imports('rtmpal.dll', 'QueryPerformanceCounter')) and (pe.imports('user32.dll', 'MessageBoxA')) and (not(pe.imports('msvcrt.dll', '__p__fmode'))) and (pe.imports('advapi32.dll', 'CopySid') or pe.imports('api-ms-win-security-base-l1-2-0.dll', 'CopySid') or pe.imports('api-ms-win-security-base-l1-1-0.dll', 'CopySid') or pe.imports('api-ms-win-downlevel-advapi32-l1-1-1.dll', 'CopySid') or pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'CopySid') or pe.imports('kernelbase.dll', 'CopySid')))} drvnskm_rule rule_cluster_3{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('kernel32.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW'))) and (pe.imports('user32.dll', 'InvalidateRect')) and (pe.imports('user32.dll', 'SetWindowsHookExA')) and (pe.imports('oleaut32.dll', 'SafeArrayGetElement')))} drvnskm_rule rule_cluster_3{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('kernel32.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW'))) and (pe.imports('user32.dll', 'InvalidateRect')) and (pe.imports('user32.dll', 'SetWindowsHookExA')) and (pe.imports('oleaut32.dll', 'SafeArrayGetElement'))) or ((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('kernel32.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW')) and (pe.imports('kernel32.dll', 'DecodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer') or pe.imports('rtmpal.dll', 'DecodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer') or pe.imports('kernelbase.dll', 'DecodePointer')) and (pe.imports('kernel32.dll', 'CompareStringW') or pe.imports('api-ms-win-core-string-l1-1-0.dll', 'CompareStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CompareStringW')) and (pe.imports('user32.dll', 'GetDesktopWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'GetDesktopWindow') or pe.imports('ext-ms-win-ntuser-window-l1-1-1.dll', 'GetDesktopWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'GetDesktopWindow')))} drvnskm_rule rule_cluster_4{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('kernel32.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW'))) and (pe.imports('user32.dll', 'InvalidateRect')) and (pe.imports('user32.dll', 'SetWindowsHookExA')) and (not(pe.imports('oleaut32.dll', 'SafeArrayGetElement'))))} drvnskm_rule rule_cluster_5{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (not(pe.imports('msvcrt.dll', 'exit')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit')) and not(pe.imports('crtdll.dll', 'exit')) and not(pe.imports('msvcr100.dll', 'exit')) and not(pe.imports('msvcr120.dll', 'exit')) and not(pe.imports('msvcr90.dll', 'exit')) and not(pe.imports('msvcr120_clr0400.dll', 'exit')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit'))) and (pe.imports('msvbvm60.dll', '__vbaStrMove')))} drvnskm_rule rule_cluster_6{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA')) and not(pe.imports('kernel32', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA'))) and (not(pe.imports('kernel32.dll', 'lstrcmpA')) and not(pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpA'))) and (not(pe.imports('kernel32.dll', 'MapViewOfFile')) and not(pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'MapViewOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'MapViewOfFile')) and not(pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'MapViewOfFile')) and not(pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'MapViewOfFile')) and not(pe.imports('rtmpal.dll', 'MapViewOfFile'))))} drvnskm_rule rule_cluster_7{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA')) and not(pe.imports('kernel32', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA'))) and (pe.imports('kernel32.dll', 'lstrcmpA') or pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpA')))} drvnskm_rule rule_cluster_8{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (not(pe.imports('msvcrt.dll', 'exit')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit')) and not(pe.imports('crtdll.dll', 'exit')) and not(pe.imports('msvcr100.dll', 'exit')) and not(pe.imports('msvcr120.dll', 'exit')) and not(pe.imports('msvcr90.dll', 'exit')) and not(pe.imports('msvcr120_clr0400.dll', 'exit')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit'))) and (not(pe.imports('msvbvm60.dll', '__vbaStrMove'))) and (not(pe.imports('ntdll.dll', 'RtlInitUnicodeString')) and not(pe.imports('ntoskrnl.exe', 'RtlInitUnicodeString')) and not(pe.imports('securekernel.exe', 'RtlInitUnicodeString')) and not(pe.imports('bootmgr.exe', 'RtlInitUnicodeString'))) and (not(pe.imports('netapi32.dll', 'NetGroupGetUsers')) and not(pe.imports('samcli.dll', 'NetGroupGetUsers'))))} drvnskm_rule rule_cluster_9{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA')) and (not(pe.imports('kernel32.dll', 'lstrcpyW')) and not(pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcpyW'))) and (not(pe.imports('msvcrt.dll', 'realloc')) and not(pe.imports('api-ms-win-crt-heap-l1-1-0.dll', 'realloc')) and not(pe.imports('msvcr120.dll', 'realloc')) and not(pe.imports('msvcr90.dll', 'realloc')) and not(pe.imports('msvcr120_clr0400.dll', 'realloc')) and not(pe.imports('msvcr80.dll', 'realloc')) and not(pe.imports('msvcrt40.dll', 'realloc'))))} drvnskm_rule rule_cluster_11{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (pe.imports('msvcrt.dll', 'exit') or pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit') or pe.imports('crtdll.dll', 'exit') or pe.imports('msvcr100.dll', 'exit') or pe.imports('msvcr120.dll', 'exit') or pe.imports('msvcr90.dll', 'exit') or pe.imports('msvcr120_clr0400.dll', 'exit') or pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit')) and (not(pe.imports('user32.dll', 'RemovePropA'))))} drvnskm_rule rule_cluster_12{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('kernel32.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW')) and (pe.imports('kernel32.dll', 'DecodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer') or pe.imports('rtmpal.dll', 'DecodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer') or pe.imports('kernelbase.dll', 'DecodePointer')) and (pe.imports('kernel32.dll', 'CompareStringW') or pe.imports('api-ms-win-core-string-l1-1-0.dll', 'CompareStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CompareStringW')) and (not(pe.imports('user32.dll', 'GetDesktopWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'GetDesktopWindow')) and not(pe.imports('ext-ms-win-ntuser-window-l1-1-1.dll', 'GetDesktopWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'GetDesktopWindow'))))} drvnskm_rule rule_cluster_13{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (pe.imports('msvcrt.dll', 'exit') or pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit') or pe.imports('crtdll.dll', 'exit') or pe.imports('msvcr100.dll', 'exit') or pe.imports('msvcr120.dll', 'exit') or pe.imports('msvcr90.dll', 'exit') or pe.imports('msvcr120_clr0400.dll', 'exit') or pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit')) and (pe.imports('user32.dll', 'RemovePropA')))} drvnskm_rule rule_cluster_13{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (pe.imports('msvcrt.dll', 'exit') or pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit') or pe.imports('crtdll.dll', 'exit') or pe.imports('msvcr100.dll', 'exit') or pe.imports('msvcr120.dll', 'exit') or pe.imports('msvcr90.dll', 'exit') or pe.imports('msvcr120_clr0400.dll', 'exit') or pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit')) and (pe.imports('user32.dll', 'RemovePropA'))) or ((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA')) and (not(pe.imports('kernel32.dll', 'lstrcpyW')) and not(pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcpyW'))) and (pe.imports('msvcrt.dll', 'realloc') or pe.imports('api-ms-win-crt-heap-l1-1-0.dll', 'realloc') or pe.imports('msvcr120.dll', 'realloc') or pe.imports('msvcr90.dll', 'realloc') or pe.imports('msvcr120_clr0400.dll', 'realloc') or pe.imports('msvcr80.dll', 'realloc') or pe.imports('msvcrt40.dll', 'realloc')))} drvnskm_rule rule_cluster_14{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('kernel32.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW')) and (pe.imports('kernel32.dll', 'DecodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer') or pe.imports('rtmpal.dll', 'DecodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer') or pe.imports('kernelbase.dll', 'DecodePointer')) and (not(pe.imports('kernel32.dll', 'CompareStringW')) and not(pe.imports('api-ms-win-core-string-l1-1-0.dll', 'CompareStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CompareStringW'))) and (not(pe.imports('kernel32.dll', 'GetLocaleInfoW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetLocaleInfoW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetLocaleInfoW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetLocaleInfoW'))) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject')))} drvnskm_rule rule_cluster_14{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('kernel32.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW')) and (pe.imports('kernel32.dll', 'DecodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer') or pe.imports('rtmpal.dll', 'DecodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer') or pe.imports('kernelbase.dll', 'DecodePointer')) and (not(pe.imports('kernel32.dll', 'CompareStringW')) and not(pe.imports('api-ms-win-core-string-l1-1-0.dll', 'CompareStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CompareStringW'))) and (not(pe.imports('kernel32.dll', 'GetLocaleInfoW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetLocaleInfoW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetLocaleInfoW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetLocaleInfoW'))) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject'))) or ((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('kernel32.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW')) and (pe.imports('kernel32.dll', 'DecodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer') or pe.imports('rtmpal.dll', 'DecodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer') or pe.imports('kernelbase.dll', 'DecodePointer')) and (not(pe.imports('kernel32.dll', 'CompareStringW')) and not(pe.imports('api-ms-win-core-string-l1-1-0.dll', 'CompareStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CompareStringW'))) and (pe.imports('kernel32.dll', 'GetLocaleInfoW') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetLocaleInfoW') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetLocaleInfoW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetLocaleInfoW')))} drvnskm_rule rule_cluster_15{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('kernel32.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW')) and (pe.imports('kernel32.dll', 'DecodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer') or pe.imports('rtmpal.dll', 'DecodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer') or pe.imports('kernelbase.dll', 'DecodePointer')) and (not(pe.imports('kernel32.dll', 'CompareStringW')) and not(pe.imports('api-ms-win-core-string-l1-1-0.dll', 'CompareStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CompareStringW'))) and (not(pe.imports('kernel32.dll', 'GetLocaleInfoW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetLocaleInfoW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetLocaleInfoW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetLocaleInfoW'))) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))))} drvnskm_rule rule_cluster_16{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('kernel32.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW'))) and (not(pe.imports('user32.dll', 'InvalidateRect'))) and (pe.imports('kernel32.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW')))} drvnskm_rule rule_cluster_17{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('kernel32.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW')) and (not(pe.imports('kernel32.dll', 'DecodePointer')) and not(pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer')) and not(pe.imports('rtmpal.dll', 'DecodePointer')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer')) and not(pe.imports('kernelbase.dll', 'DecodePointer'))) and (pe.imports('kernel32.dll', 'SetCurrentDirectoryW') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'SetCurrentDirectoryW') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'SetCurrentDirectoryW')))} drvnskm_rule rule_cluster_18{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA')) and (pe.imports('kernel32.dll', 'lstrcpyW') or pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcpyW')))} drvnskm_rule rule_cluster_18{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA')) and (pe.imports('kernel32.dll', 'lstrcpyW') or pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcpyW'))) or ((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (pe.imports('kernel32.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('kernelbase.dll', 'QueryPerformanceCounter') or pe.imports('rtmpal.dll', 'QueryPerformanceCounter')) and (pe.imports('user32.dll', 'MessageBoxA')) and (not(pe.imports('msvcrt.dll', '__p__fmode'))) and (not(pe.imports('advapi32.dll', 'CopySid')) and not(pe.imports('api-ms-win-security-base-l1-2-0.dll', 'CopySid')) and not(pe.imports('api-ms-win-security-base-l1-1-0.dll', 'CopySid')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-1.dll', 'CopySid')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'CopySid')) and not(pe.imports('kernelbase.dll', 'CopySid'))))} drvnskm_rule rule_cluster_18{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA')) and (pe.imports('kernel32.dll', 'lstrcpyW') or pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcpyW'))) or ((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (pe.imports('kernel32.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('kernelbase.dll', 'QueryPerformanceCounter') or pe.imports('rtmpal.dll', 'QueryPerformanceCounter')) and (pe.imports('user32.dll', 'MessageBoxA')) and (not(pe.imports('msvcrt.dll', '__p__fmode'))) and (not(pe.imports('advapi32.dll', 'CopySid')) and not(pe.imports('api-ms-win-security-base-l1-2-0.dll', 'CopySid')) and not(pe.imports('api-ms-win-security-base-l1-1-0.dll', 'CopySid')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-1.dll', 'CopySid')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'CopySid')) and not(pe.imports('kernelbase.dll', 'CopySid')))) or ((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('kernel32.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW'))) and (pe.imports('user32.dll', 'InvalidateRect')) and (not(pe.imports('user32.dll', 'SetWindowsHookExA'))))} drvnskm_rule rule_cluster_19{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (pe.imports('kernel32.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('kernelbase.dll', 'QueryPerformanceCounter') or pe.imports('rtmpal.dll', 'QueryPerformanceCounter')) and (pe.imports('user32.dll', 'MessageBoxA')) and (pe.imports('msvcrt.dll', '__p__fmode')))} drvnskm_rule rule_cluster_20{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('kernel32.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileW'))) and (pe.imports('user32.dll', 'InvalidateRect')) and (not(pe.imports('user32.dll', 'SetWindowsHookExA'))))}