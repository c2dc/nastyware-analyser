drvnskm_rule rule_cluster_0{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile'))) and (pe.imports('kernel32.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW')) and (not(pe.imports('kernel32.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'ReadFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'ReadFile'))) and (not(pe.imports('kernel32.dll', 'GetCommandLineW')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCommandLineW')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineW'))))} drvnskm_rule rule_cluster_1{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('kernel32.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile')) and (not(pe.imports('kernel32.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'CreateThread')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateThread')) and not(pe.imports('rtmpal.dll', 'CreateThread'))) and (not(pe.imports('api-ms-win-core-registry-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('advapi32.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-core-localregistry-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('kernel32.dll', 'RegEnumKeyExW')) and not(pe.imports('kernelbase.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-1.dll', 'RegEnumKeyExW'))) and (not(pe.imports('kernel32.dll', 'GetFileAttributesA')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'GetFileAttributesA')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'GetFileAttributesA'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW')) and not(pe.imports('rtmpal.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW'))) and (pe.imports('mscms.dll', 'EnumColorProfilesA')))} drvnskm_rule rule_cluster_1{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('kernel32.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile')) and (not(pe.imports('kernel32.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'CreateThread')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateThread')) and not(pe.imports('rtmpal.dll', 'CreateThread'))) and (not(pe.imports('api-ms-win-core-registry-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('advapi32.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-core-localregistry-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('kernel32.dll', 'RegEnumKeyExW')) and not(pe.imports('kernelbase.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-1.dll', 'RegEnumKeyExW'))) and (not(pe.imports('kernel32.dll', 'GetFileAttributesA')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'GetFileAttributesA')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'GetFileAttributesA'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW')) and not(pe.imports('rtmpal.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW'))) and (pe.imports('mscms.dll', 'EnumColorProfilesA'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('kernel32.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile')) and (not(pe.imports('kernel32.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'CreateThread')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateThread')) and not(pe.imports('rtmpal.dll', 'CreateThread'))) and (not(pe.imports('api-ms-win-core-registry-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('advapi32.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-core-localregistry-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('kernel32.dll', 'RegEnumKeyExW')) and not(pe.imports('kernelbase.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-1.dll', 'RegEnumKeyExW'))) and (not(pe.imports('kernel32.dll', 'GetFileAttributesA')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'GetFileAttributesA')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'GetFileAttributesA'))) and (pe.imports('kernel32.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW') or pe.imports('rtmpal.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW') or pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW')))} drvnskm_rule rule_cluster_2{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentThreadId')) and not(pe.imports('rtmpal.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('kernelbase.dll', 'GetCurrentThreadId'))) and (not(pe.imports('msvcrt.dll', 'exit')) and not(pe.imports('crtdll.dll', 'exit')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit')) and not(pe.imports('msvcr100.dll', 'exit')) and not(pe.imports('msvcr120.dll', 'exit')) and not(pe.imports('msvcr90.dll', 'exit')) and not(pe.imports('msvcr120_clr0400.dll', 'exit')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit'))) and (pe.imports('kernel32.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW') or pe.imports('rtmpal.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW') or pe.imports('kernelbase.dll', 'GetModuleHandleW')) and (not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('user32.dll', 'GetTopWindow'))))} drvnskm_rule rule_cluster_2{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentThreadId')) and not(pe.imports('rtmpal.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('kernelbase.dll', 'GetCurrentThreadId'))) and (not(pe.imports('msvcrt.dll', 'exit')) and not(pe.imports('crtdll.dll', 'exit')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit')) and not(pe.imports('msvcr100.dll', 'exit')) and not(pe.imports('msvcr120.dll', 'exit')) and not(pe.imports('msvcr90.dll', 'exit')) and not(pe.imports('msvcr120_clr0400.dll', 'exit')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit'))) and (pe.imports('kernel32.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW') or pe.imports('rtmpal.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW') or pe.imports('kernelbase.dll', 'GetModuleHandleW')) and (not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('user32.dll', 'GetTopWindow')))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile'))) and (not(pe.imports('kernel32.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW'))) and (pe.imports('kernel32.dll', 'GetVersion') or pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetVersion') or pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetVersion') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetVersion')) and (not(pe.imports('advapi32.dll', 'LookupPrivilegeValueA'))))} drvnskm_rule rule_cluster_3{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentThreadId')) and not(pe.imports('rtmpal.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('kernelbase.dll', 'GetCurrentThreadId'))) and (not(pe.imports('msvcrt.dll', 'exit')) and not(pe.imports('crtdll.dll', 'exit')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit')) and not(pe.imports('msvcr100.dll', 'exit')) and not(pe.imports('msvcr120.dll', 'exit')) and not(pe.imports('msvcr90.dll', 'exit')) and not(pe.imports('msvcr120_clr0400.dll', 'exit')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('ntdll.dll', 'RtlInitUnicodeString')) and not(pe.imports('ntoskrnl.exe', 'RtlInitUnicodeString')) and not(pe.imports('securekernel.exe', 'RtlInitUnicodeString')) and not(pe.imports('bootmgr.exe', 'RtlInitUnicodeString'))) and (pe.imports('kernel32.dll', 'LoadLibraryExA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'LoadLibraryExA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'LoadLibraryExA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'LoadLibraryExA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LoadLibraryExA') or pe.imports('rtmpal.dll', 'LoadLibraryExA')) and (not(pe.imports('setupapi.dll', 'CM_Free_Log_Conf_Handle')) and not(pe.imports('cfgmgr32.dll', 'CM_Free_Log_Conf_Handle'))))} drvnskm_rule rule_cluster_5{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentThreadId')) and not(pe.imports('rtmpal.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('kernelbase.dll', 'GetCurrentThreadId'))) and (pe.imports('msvcrt.dll', 'exit') or pe.imports('crtdll.dll', 'exit') or pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit') or pe.imports('msvcr100.dll', 'exit') or pe.imports('msvcr120.dll', 'exit') or pe.imports('msvcr90.dll', 'exit') or pe.imports('msvcr120_clr0400.dll', 'exit') or pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit')) and (pe.imports('loadperf.dll', 'UnloadPerfCounterTextStringsA')))} drvnskm_rule rule_cluster_6{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile'))) and (not(pe.imports('kernel32.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW'))) and (pe.imports('kernel32.dll', 'GetVersion') or pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetVersion') or pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetVersion') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetVersion')) and (pe.imports('advapi32.dll', 'LookupPrivilegeValueA')))} drvnskm_rule rule_cluster_7{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile'))) and (not(pe.imports('kernel32.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW'))) and (not(pe.imports('kernel32.dll', 'GetVersion')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetVersion')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetVersion')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetVersion'))) and (pe.imports('kernel32.dll', 'SetFilePointer') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetFilePointer') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetFilePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetFilePointer') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetFilePointer')))} drvnskm_rule rule_cluster_8{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile'))) and (pe.imports('kernel32.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW')) and (not(pe.imports('kernel32.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'ReadFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'ReadFile'))) and (pe.imports('kernel32.dll', 'GetCommandLineW') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCommandLineW') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineW')))} drvnskm_rule rule_cluster_8{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile'))) and (pe.imports('kernel32.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW')) and (not(pe.imports('kernel32.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'ReadFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'ReadFile'))) and (pe.imports('kernel32.dll', 'GetCommandLineW') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCommandLineW') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineW'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('kernel32.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile')) and (pe.imports('kernel32.dll', 'CreateThread') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'CreateThread') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'CreateThread') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'CreateThread') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateThread') or pe.imports('rtmpal.dll', 'CreateThread')) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))))} drvnskm_rule rule_cluster_9{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile'))) and (pe.imports('kernel32.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW')) and (pe.imports('kernel32.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'ReadFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'ReadFile')) and (pe.imports('kernel32.dll', 'ExitThread') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitThread') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitThread') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitThread')))} drvnskm_rule rule_cluster_9{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile'))) and (pe.imports('kernel32.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW')) and (pe.imports('kernel32.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'ReadFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'ReadFile')) and (pe.imports('kernel32.dll', 'ExitThread') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitThread') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitThread') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitThread'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('kernel32.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile')) and (not(pe.imports('kernel32.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'CreateThread')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateThread')) and not(pe.imports('rtmpal.dll', 'CreateThread'))) and (not(pe.imports('api-ms-win-core-registry-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('advapi32.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-core-localregistry-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('kernel32.dll', 'RegEnumKeyExW')) and not(pe.imports('kernelbase.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-1.dll', 'RegEnumKeyExW'))) and (not(pe.imports('kernel32.dll', 'GetFileAttributesA')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'GetFileAttributesA')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'GetFileAttributesA'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW')) and not(pe.imports('rtmpal.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW'))) and (not(pe.imports('mscms.dll', 'EnumColorProfilesA'))))} drvnskm_rule rule_cluster_9{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile'))) and (pe.imports('kernel32.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW')) and (pe.imports('kernel32.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'ReadFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'ReadFile')) and (pe.imports('kernel32.dll', 'ExitThread') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitThread') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitThread') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitThread'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('kernel32.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile')) and (not(pe.imports('kernel32.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'CreateThread')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateThread')) and not(pe.imports('rtmpal.dll', 'CreateThread'))) and (not(pe.imports('api-ms-win-core-registry-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('advapi32.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-core-localregistry-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('kernel32.dll', 'RegEnumKeyExW')) and not(pe.imports('kernelbase.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-1.dll', 'RegEnumKeyExW'))) and (not(pe.imports('kernel32.dll', 'GetFileAttributesA')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'GetFileAttributesA')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'GetFileAttributesA'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW')) and not(pe.imports('rtmpal.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW'))) and (not(pe.imports('mscms.dll', 'EnumColorProfilesA')))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('kernel32.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile')) and (not(pe.imports('kernel32.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'CreateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'CreateThread')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateThread')) and not(pe.imports('rtmpal.dll', 'CreateThread'))) and (not(pe.imports('api-ms-win-core-registry-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('advapi32.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-core-localregistry-l1-1-0.dll', 'RegEnumKeyExW')) and not(pe.imports('kernel32.dll', 'RegEnumKeyExW')) and not(pe.imports('kernelbase.dll', 'RegEnumKeyExW')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-1.dll', 'RegEnumKeyExW'))) and (pe.imports('kernel32.dll', 'GetFileAttributesA') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'GetFileAttributesA') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'GetFileAttributesA')))} drvnskm_rule rule_cluster_10{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile'))) and (pe.imports('kernel32.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW')) and (pe.imports('kernel32.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'ReadFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'ReadFile')) and (not(pe.imports('kernel32.dll', 'ExitThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitThread'))))} drvnskm_rule rule_cluster_11{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentThreadId')) and not(pe.imports('rtmpal.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('kernelbase.dll', 'GetCurrentThreadId'))) and (pe.imports('msvcrt.dll', 'exit') or pe.imports('crtdll.dll', 'exit') or pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit') or pe.imports('msvcr100.dll', 'exit') or pe.imports('msvcr120.dll', 'exit') or pe.imports('msvcr90.dll', 'exit') or pe.imports('msvcr120_clr0400.dll', 'exit') or pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit')) and (not(pe.imports('loadperf.dll', 'UnloadPerfCounterTextStringsA'))))} drvnskm_rule rule_cluster_12{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentThreadId')) and not(pe.imports('rtmpal.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('kernelbase.dll', 'GetCurrentThreadId'))) and (not(pe.imports('msvcrt.dll', 'exit')) and not(pe.imports('crtdll.dll', 'exit')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit')) and not(pe.imports('msvcr100.dll', 'exit')) and not(pe.imports('msvcr120.dll', 'exit')) and not(pe.imports('msvcr90.dll', 'exit')) and not(pe.imports('msvcr120_clr0400.dll', 'exit')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('ntdll.dll', 'RtlInitUnicodeString')) and not(pe.imports('ntoskrnl.exe', 'RtlInitUnicodeString')) and not(pe.imports('securekernel.exe', 'RtlInitUnicodeString')) and not(pe.imports('bootmgr.exe', 'RtlInitUnicodeString'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LoadLibraryExA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryExA'))) and (pe.imports('msvbvm60.dll', '_allmul') or pe.imports('ntdll.dll', '_allmul') or pe.imports('bootmgr.exe', '_allmul') or pe.imports('ntoskrnl.exe', '_allmul')))} drvnskm_rule rule_cluster_13{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentThreadId')) and not(pe.imports('rtmpal.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('kernelbase.dll', 'GetCurrentThreadId'))) and (not(pe.imports('msvcrt.dll', 'exit')) and not(pe.imports('crtdll.dll', 'exit')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit')) and not(pe.imports('msvcr100.dll', 'exit')) and not(pe.imports('msvcr120.dll', 'exit')) and not(pe.imports('msvcr90.dll', 'exit')) and not(pe.imports('msvcr120_clr0400.dll', 'exit')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('ntdll.dll', 'RtlInitUnicodeString')) and not(pe.imports('ntoskrnl.exe', 'RtlInitUnicodeString')) and not(pe.imports('securekernel.exe', 'RtlInitUnicodeString')) and not(pe.imports('bootmgr.exe', 'RtlInitUnicodeString'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LoadLibraryExA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryExA'))) and (not(pe.imports('msvbvm60.dll', '_allmul')) and not(pe.imports('ntdll.dll', '_allmul')) and not(pe.imports('bootmgr.exe', '_allmul')) and not(pe.imports('ntoskrnl.exe', '_allmul'))) and (pe.imports('kernel32.dll', 'GetProcessHeap') or pe.imports('api-ms-win-core-heap-l1-2-0.dll', 'GetProcessHeap') or pe.imports('rtmpal.dll', 'GetProcessHeap') or pe.imports('api-ms-win-core-heap-l1-1-0.dll', 'GetProcessHeap') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcessHeap') or pe.imports('kernelbase.dll', 'GetProcessHeap')))} drvnskm_rule rule_cluster_13{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentThreadId')) and not(pe.imports('rtmpal.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('kernelbase.dll', 'GetCurrentThreadId'))) and (not(pe.imports('msvcrt.dll', 'exit')) and not(pe.imports('crtdll.dll', 'exit')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit')) and not(pe.imports('msvcr100.dll', 'exit')) and not(pe.imports('msvcr120.dll', 'exit')) and not(pe.imports('msvcr90.dll', 'exit')) and not(pe.imports('msvcr120_clr0400.dll', 'exit')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('ntdll.dll', 'RtlInitUnicodeString')) and not(pe.imports('ntoskrnl.exe', 'RtlInitUnicodeString')) and not(pe.imports('securekernel.exe', 'RtlInitUnicodeString')) and not(pe.imports('bootmgr.exe', 'RtlInitUnicodeString'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LoadLibraryExA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryExA'))) and (not(pe.imports('msvbvm60.dll', '_allmul')) and not(pe.imports('ntdll.dll', '_allmul')) and not(pe.imports('bootmgr.exe', '_allmul')) and not(pe.imports('ntoskrnl.exe', '_allmul'))) and (pe.imports('kernel32.dll', 'GetProcessHeap') or pe.imports('api-ms-win-core-heap-l1-2-0.dll', 'GetProcessHeap') or pe.imports('rtmpal.dll', 'GetProcessHeap') or pe.imports('api-ms-win-core-heap-l1-1-0.dll', 'GetProcessHeap') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcessHeap') or pe.imports('kernelbase.dll', 'GetProcessHeap'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile'))) and (not(pe.imports('kernel32.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW'))) and (not(pe.imports('kernel32.dll', 'GetVersion')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetVersion')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetVersion')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetVersion'))) and (not(pe.imports('kernel32.dll', 'SetFilePointer')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetFilePointer')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetFilePointer')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetFilePointer')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetFilePointer'))) and (pe.imports('kernel32.dll', 'VirtualFree') or pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'VirtualFree') or pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'VirtualFree') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'VirtualFree') or pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'VirtualFree')))} drvnskm_rule rule_cluster_14{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentThreadId')) and not(pe.imports('rtmpal.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('kernelbase.dll', 'GetCurrentThreadId'))) and (not(pe.imports('msvcrt.dll', 'exit')) and not(pe.imports('crtdll.dll', 'exit')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit')) and not(pe.imports('msvcr100.dll', 'exit')) and not(pe.imports('msvcr120.dll', 'exit')) and not(pe.imports('msvcr90.dll', 'exit')) and not(pe.imports('msvcr120_clr0400.dll', 'exit')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('ntdll.dll', 'RtlInitUnicodeString')) and not(pe.imports('ntoskrnl.exe', 'RtlInitUnicodeString')) and not(pe.imports('securekernel.exe', 'RtlInitUnicodeString')) and not(pe.imports('bootmgr.exe', 'RtlInitUnicodeString'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LoadLibraryExA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryExA'))) and (not(pe.imports('msvbvm60.dll', '_allmul')) and not(pe.imports('ntdll.dll', '_allmul')) and not(pe.imports('bootmgr.exe', '_allmul')) and not(pe.imports('ntoskrnl.exe', '_allmul'))) and (not(pe.imports('kernel32.dll', 'GetProcessHeap')) and not(pe.imports('api-ms-win-core-heap-l1-2-0.dll', 'GetProcessHeap')) and not(pe.imports('rtmpal.dll', 'GetProcessHeap')) and not(pe.imports('api-ms-win-core-heap-l1-1-0.dll', 'GetProcessHeap')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcessHeap')) and not(pe.imports('kernelbase.dll', 'GetProcessHeap'))))} drvnskm_rule rule_cluster_14{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentThreadId')) and not(pe.imports('rtmpal.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('kernelbase.dll', 'GetCurrentThreadId'))) and (not(pe.imports('msvcrt.dll', 'exit')) and not(pe.imports('crtdll.dll', 'exit')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit')) and not(pe.imports('msvcr100.dll', 'exit')) and not(pe.imports('msvcr120.dll', 'exit')) and not(pe.imports('msvcr90.dll', 'exit')) and not(pe.imports('msvcr120_clr0400.dll', 'exit')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('ntdll.dll', 'RtlInitUnicodeString')) and not(pe.imports('ntoskrnl.exe', 'RtlInitUnicodeString')) and not(pe.imports('securekernel.exe', 'RtlInitUnicodeString')) and not(pe.imports('bootmgr.exe', 'RtlInitUnicodeString'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'LoadLibraryExA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LoadLibraryExA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryExA'))) and (not(pe.imports('msvbvm60.dll', '_allmul')) and not(pe.imports('ntdll.dll', '_allmul')) and not(pe.imports('bootmgr.exe', '_allmul')) and not(pe.imports('ntoskrnl.exe', '_allmul'))) and (not(pe.imports('kernel32.dll', 'GetProcessHeap')) and not(pe.imports('api-ms-win-core-heap-l1-2-0.dll', 'GetProcessHeap')) and not(pe.imports('rtmpal.dll', 'GetProcessHeap')) and not(pe.imports('api-ms-win-core-heap-l1-1-0.dll', 'GetProcessHeap')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcessHeap')) and not(pe.imports('kernelbase.dll', 'GetProcessHeap')))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetEndOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEndOfFile'))) and (not(pe.imports('kernel32.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW'))) and (not(pe.imports('kernel32.dll', 'GetVersion')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetVersion')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetVersion')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetVersion'))) and (not(pe.imports('kernel32.dll', 'SetFilePointer')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetFilePointer')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetFilePointer')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetFilePointer')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetFilePointer'))) and (not(pe.imports('kernel32.dll', 'VirtualFree')) and not(pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'VirtualFree')) and not(pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'VirtualFree')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'VirtualFree')) and not(pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'VirtualFree'))))} drvnskm_rule rule_cluster_15{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentThreadId')) and not(pe.imports('rtmpal.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentThreadId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentThreadId')) and not(pe.imports('kernelbase.dll', 'GetCurrentThreadId'))) and (not(pe.imports('msvcrt.dll', 'exit')) and not(pe.imports('crtdll.dll', 'exit')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', 'exit')) and not(pe.imports('msvcr100.dll', 'exit')) and not(pe.imports('msvcr120.dll', 'exit')) and not(pe.imports('msvcr90.dll', 'exit')) and not(pe.imports('msvcr120_clr0400.dll', 'exit')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', 'exit'))) and (pe.imports('kernel32.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW') or pe.imports('rtmpal.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW') or pe.imports('kernelbase.dll', 'GetModuleHandleW')) and (pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')))}