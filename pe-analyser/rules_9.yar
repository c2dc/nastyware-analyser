drvnskm_rule rule_cluster_0{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (not(pe.imports('kernel32.dll', 'SetFilePointerEx')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetFilePointerEx')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetFilePointerEx')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetFilePointerEx')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetFilePointerEx'))) and (pe.imports('kernel32.dll', 'LocalAlloc') or pe.imports('api-ms-win-core-heap-l2-1-0.dll', 'LocalAlloc') or pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'LocalAlloc') or pe.imports('kernelbase.dll', 'LocalAlloc') or pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LocalAlloc') or pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'LocalAlloc')) and (pe.imports('gdi32.dll', 'DeleteObject')))} drvnskm_rule rule_cluster_1{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject')) and (pe.imports('kernel32.dll', 'DeleteCriticalSection') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'DeleteCriticalSection') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'DeleteCriticalSection') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DeleteCriticalSection') or pe.imports('rtmpal.dll', 'DeleteCriticalSection') or pe.imports('kernelbase.dll', 'DeleteCriticalSection')) and (pe.imports('kernel32.dll', 'SetEvent') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'SetEvent') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'SetEvent') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEvent') or pe.imports('rtmpal.dll', 'SetEvent') or pe.imports('kernelbase.dll', 'SetEvent')) and (pe.imports('user32.dll', 'CharToOemA')) and (not(pe.imports('user32.dll', 'GetMessageTime')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'GetMessageTime'))))} drvnskm_rule rule_cluster_2{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (pe.imports('kernel32.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetFilePointerEx')) and (not(pe.imports('kernel32.dll', 'GetCommandLineW')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCommandLineW')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineW'))) and (not(pe.imports('wsock32.dll', 'WSACleanup')) and not(pe.imports('ws2_32.dll', 'WSACleanup')) and not(pe.imports('ws2', 'WSACleanup'))))} drvnskm_rule rule_cluster_3{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (pe.imports('kernel32.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetFilePointerEx')) and (not(pe.imports('kernel32.dll', 'GetCommandLineW')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCommandLineW')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineW'))) and (pe.imports('wsock32.dll', 'WSACleanup') or pe.imports('ws2_32.dll', 'WSACleanup') or pe.imports('ws2', 'WSACleanup')))} drvnskm_rule rule_cluster_4{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (not(pe.imports('kernel32.dll', 'SetFilePointerEx')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetFilePointerEx')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetFilePointerEx')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetFilePointerEx')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetFilePointerEx'))) and (pe.imports('kernel32.dll', 'LocalAlloc') or pe.imports('api-ms-win-core-heap-l2-1-0.dll', 'LocalAlloc') or pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'LocalAlloc') or pe.imports('kernelbase.dll', 'LocalAlloc') or pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LocalAlloc') or pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'LocalAlloc')) and (not(pe.imports('gdi32.dll', 'DeleteObject'))))} drvnskm_rule rule_cluster_5{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (not(pe.imports('kernel32.dll', 'SetFilePointerEx')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetFilePointerEx')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetFilePointerEx')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetFilePointerEx')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetFilePointerEx'))) and (not(pe.imports('kernel32.dll', 'LocalAlloc')) and not(pe.imports('api-ms-win-core-heap-l2-1-0.dll', 'LocalAlloc')) and not(pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'LocalAlloc')) and not(pe.imports('kernelbase.dll', 'LocalAlloc')) and not(pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LocalAlloc')) and not(pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'LocalAlloc'))))} drvnskm_rule rule_cluster_6{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (pe.imports('kernel32.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetFilePointerEx')) and (pe.imports('kernel32.dll', 'GetCommandLineW') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCommandLineW') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineW')) and (pe.imports('kernel32.dll', 'EncodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'EncodePointer') or pe.imports('rtmpal.dll', 'EncodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'EncodePointer') or pe.imports('kernelbase.dll', 'EncodePointer')) and (not(pe.imports('kernel32.dll', 'GetEnvironmentVariableA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetEnvironmentVariableA'))))} drvnskm_rule rule_cluster_7{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject')) and (not(pe.imports('kernel32.dll', 'DeleteCriticalSection')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'DeleteCriticalSection')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'DeleteCriticalSection')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DeleteCriticalSection')) and not(pe.imports('rtmpal.dll', 'DeleteCriticalSection')) and not(pe.imports('kernelbase.dll', 'DeleteCriticalSection'))))} drvnskm_rule rule_cluster_8{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime') or pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime') or pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime') or pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime') or pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime') or pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime')) and (pe.imports('kernel32.dll', 'SetCurrentDirectoryA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'SetCurrentDirectoryA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'SetCurrentDirectoryA')))} drvnskm_rule rule_cluster_8{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime') or pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime') or pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime') or pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime') or pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime') or pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime')) and (pe.imports('kernel32.dll', 'SetCurrentDirectoryA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'SetCurrentDirectoryA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'SetCurrentDirectoryA'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject')) and (pe.imports('kernel32.dll', 'DeleteCriticalSection') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'DeleteCriticalSection') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'DeleteCriticalSection') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DeleteCriticalSection') or pe.imports('rtmpal.dll', 'DeleteCriticalSection') or pe.imports('kernelbase.dll', 'DeleteCriticalSection')) and (not(pe.imports('kernel32.dll', 'SetEvent')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'SetEvent')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'SetEvent')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEvent')) and not(pe.imports('rtmpal.dll', 'SetEvent')) and not(pe.imports('kernelbase.dll', 'SetEvent'))) and (pe.imports('kernel32.dll', 'DecodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer') or pe.imports('rtmpal.dll', 'DecodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer') or pe.imports('kernelbase.dll', 'DecodePointer')))} drvnskm_rule rule_cluster_9{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('user32.dll', 'RegisterClassA'))) and (pe.imports('msvbvm60.dll', '__vbaExceptHandler')))} drvnskm_rule rule_cluster_10{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('user32.dll', 'RegisterClassA'))) and (not(pe.imports('msvbvm60.dll', '__vbaExceptHandler'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'VirtualProtect')) and not(pe.imports('rtmpal.dll', 'VirtualProtect'))))} drvnskm_rule rule_cluster_11{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (pe.imports('user32.dll', 'RegisterClassA')) and (pe.imports('user32.dll', 'AppendMenuA')))} drvnskm_rule rule_cluster_13{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (pe.imports('kernel32.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetFilePointerEx')) and (pe.imports('kernel32.dll', 'GetCommandLineW') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCommandLineW') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineW')) and (pe.imports('kernel32.dll', 'EncodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'EncodePointer') or pe.imports('rtmpal.dll', 'EncodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'EncodePointer') or pe.imports('kernelbase.dll', 'EncodePointer')) and (pe.imports('kernel32.dll', 'GetEnvironmentVariableA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetEnvironmentVariableA')))} drvnskm_rule rule_cluster_13{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (pe.imports('kernel32.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetFilePointerEx')) and (pe.imports('kernel32.dll', 'GetCommandLineW') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCommandLineW') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineW')) and (pe.imports('kernel32.dll', 'EncodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'EncodePointer') or pe.imports('rtmpal.dll', 'EncodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'EncodePointer') or pe.imports('kernelbase.dll', 'EncodePointer')) and (pe.imports('kernel32.dll', 'GetEnvironmentVariableA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetEnvironmentVariableA'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject')) and (pe.imports('kernel32.dll', 'DeleteCriticalSection') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'DeleteCriticalSection') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'DeleteCriticalSection') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DeleteCriticalSection') or pe.imports('rtmpal.dll', 'DeleteCriticalSection') or pe.imports('kernelbase.dll', 'DeleteCriticalSection')) and (not(pe.imports('kernel32.dll', 'SetEvent')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'SetEvent')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'SetEvent')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetEvent')) and not(pe.imports('rtmpal.dll', 'SetEvent')) and not(pe.imports('kernelbase.dll', 'SetEvent'))) and (not(pe.imports('kernel32.dll', 'DecodePointer')) and not(pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer')) and not(pe.imports('rtmpal.dll', 'DecodePointer')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer')) and not(pe.imports('kernelbase.dll', 'DecodePointer'))))} drvnskm_rule rule_cluster_14{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (pe.imports('kernel32.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'SetFilePointerEx') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetFilePointerEx')) and (pe.imports('kernel32.dll', 'GetCommandLineW') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCommandLineW') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineW')) and (not(pe.imports('kernel32.dll', 'EncodePointer')) and not(pe.imports('api-ms-win-core-util-l1-1-0.dll', 'EncodePointer')) and not(pe.imports('rtmpal.dll', 'EncodePointer')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'EncodePointer')) and not(pe.imports('kernelbase.dll', 'EncodePointer'))))}