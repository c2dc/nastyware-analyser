drvnskm_rule rule_cluster_0{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (not(pe.imports('msvbvm60.dll', '__vbaFPException'))) and (pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (not(pe.imports('oleaut32.dll', 'VarBstrFromI4'))))} drvnskm_rule rule_cluster_1{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (not(pe.imports('msvbvm60.dll', '__vbaFPException'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('kernel32.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle'))) and (not(pe.imports('msacm32.dll', 'acmFilterEnumW'))) and (pe.imports('user32.dll', 'GetFocus') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'GetFocus')))} drvnskm_rule rule_cluster_1{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (not(pe.imports('msvbvm60.dll', '__vbaFPException'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('kernel32.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle'))) and (not(pe.imports('msacm32.dll', 'acmFilterEnumW'))) and (pe.imports('user32.dll', 'GetFocus') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'GetFocus'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (not(pe.imports('kernel32.dll', 'SetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError')) and not(pe.imports('rtmpal.dll', 'SetLastError')) and not(pe.imports('kernelbase.dll', 'SetLastError'))) and (not(pe.imports('kernel32.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('kernelbase.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('rtmpal.dll', 'SetUnhandledExceptionFilter'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA')) and not(pe.imports('kernel32', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA'))))} drvnskm_rule rule_cluster_2{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('user32.dll', 'DestroyWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and (not(pe.imports('user32.dll', 'PeekMessageA'))) and (pe.imports('user32.dll', 'SetWindowPos') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'SetWindowPos')) and (pe.imports('msvcrt.dll', 'wcscmp') or pe.imports('ntdll.dll', 'wcscmp') or pe.imports('msvcr120.dll', 'wcscmp') or pe.imports('ntoskrnl.exe', 'wcscmp') or pe.imports('api-ms-win-crt-string-l1-1-0.dll', 'wcscmp') or pe.imports('msvcrt40.dll', 'wcscmp') or pe.imports('securekernel.exe', 'wcscmp') or pe.imports('api-ms-win-core-crt-l1-1-0.dll', 'wcscmp')))} drvnskm_rule rule_cluster_3{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (not(pe.imports('kernel32.dll', 'SetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError')) and not(pe.imports('rtmpal.dll', 'SetLastError')) and not(pe.imports('kernelbase.dll', 'SetLastError'))) and (not(pe.imports('kernel32.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('kernelbase.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('rtmpal.dll', 'SetUnhandledExceptionFilter'))) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA')) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject')))} drvnskm_rule rule_cluster_3{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (not(pe.imports('kernel32.dll', 'SetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError')) and not(pe.imports('rtmpal.dll', 'SetLastError')) and not(pe.imports('kernelbase.dll', 'SetLastError'))) and (not(pe.imports('kernel32.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('kernelbase.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('rtmpal.dll', 'SetUnhandledExceptionFilter'))) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA')) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('user32.dll', 'DestroyWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and (not(pe.imports('user32.dll', 'PeekMessageA'))) and (not(pe.imports('user32.dll', 'SetWindowPos')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'SetWindowPos'))) and (pe.imports('advapi32.dll', 'AdjustTokenPrivileges') or pe.imports('api-ms-win-security-base-l1-2-0.dll', 'AdjustTokenPrivileges') or pe.imports('api-ms-win-security-base-l1-1-0.dll', 'AdjustTokenPrivileges') or pe.imports('api-ms-win-downlevel-advapi32-l1-1-1.dll', 'AdjustTokenPrivileges') or pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'AdjustTokenPrivileges')))} drvnskm_rule rule_cluster_4{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError') or pe.imports('rtmpal.dll', 'SetLastError') or pe.imports('kernelbase.dll', 'SetLastError')) and (not(pe.imports('kernel32.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW')) and not(pe.imports('rtmpal.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW'))) and (pe.imports('kernel32.dll', 'lstrcatA')))} drvnskm_rule rule_cluster_4{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError') or pe.imports('rtmpal.dll', 'SetLastError') or pe.imports('kernelbase.dll', 'SetLastError')) and (not(pe.imports('kernel32.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW')) and not(pe.imports('rtmpal.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW'))) and (pe.imports('kernel32.dll', 'lstrcatA'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError') or pe.imports('rtmpal.dll', 'SetLastError') or pe.imports('kernelbase.dll', 'SetLastError')) and (pe.imports('kernel32.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW') or pe.imports('rtmpal.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW') or pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW')) and (pe.imports('kernel32.dll', 'LocalFileTimeToFileTime') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'LocalFileTimeToFileTime') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'LocalFileTimeToFileTime') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'LocalFileTimeToFileTime')) and (not(pe.imports('kernel32.dll', 'GetShortPathNameW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'GetShortPathNameW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'GetShortPathNameW'))))} drvnskm_rule rule_cluster_5{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('user32.dll', 'DestroyWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and (not(pe.imports('user32.dll', 'PeekMessageA'))) and (not(pe.imports('user32.dll', 'SetWindowPos')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'SetWindowPos'))) and (not(pe.imports('advapi32.dll', 'AdjustTokenPrivileges')) and not(pe.imports('api-ms-win-security-base-l1-2-0.dll', 'AdjustTokenPrivileges')) and not(pe.imports('api-ms-win-security-base-l1-1-0.dll', 'AdjustTokenPrivileges')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-1.dll', 'AdjustTokenPrivileges')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'AdjustTokenPrivileges'))))} drvnskm_rule rule_cluster_6{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (not(pe.imports('msvbvm60.dll', '__vbaFPException'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (pe.imports('kernel32.dll', 'GetStdHandle') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle')) and (pe.imports('kernel32.dll', 'CreateDirectoryW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateDirectoryW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateDirectoryW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateDirectoryW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateDirectoryW')))} drvnskm_rule rule_cluster_6{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (not(pe.imports('msvbvm60.dll', '__vbaFPException'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (pe.imports('kernel32.dll', 'GetStdHandle') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle')) and (pe.imports('kernel32.dll', 'CreateDirectoryW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateDirectoryW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateDirectoryW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateDirectoryW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateDirectoryW'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError') or pe.imports('rtmpal.dll', 'SetLastError') or pe.imports('kernelbase.dll', 'SetLastError')) and (pe.imports('kernel32.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW') or pe.imports('rtmpal.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW') or pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW')) and (pe.imports('kernel32.dll', 'LocalFileTimeToFileTime') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'LocalFileTimeToFileTime') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'LocalFileTimeToFileTime') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'LocalFileTimeToFileTime')) and (pe.imports('kernel32.dll', 'GetShortPathNameW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'GetShortPathNameW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'GetShortPathNameW')))} drvnskm_rule rule_cluster_7{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError') or pe.imports('rtmpal.dll', 'SetLastError') or pe.imports('kernelbase.dll', 'SetLastError')) and (not(pe.imports('kernel32.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW')) and not(pe.imports('rtmpal.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW'))) and (not(pe.imports('kernel32.dll', 'lstrcatA'))) and (pe.imports('ws2_32.dll', 'ntohl') or pe.imports('wsock32.dll', 'ntohl') or pe.imports('ws2', 'ntohl')))} drvnskm_rule rule_cluster_7{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError') or pe.imports('rtmpal.dll', 'SetLastError') or pe.imports('kernelbase.dll', 'SetLastError')) and (not(pe.imports('kernel32.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW')) and not(pe.imports('rtmpal.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW'))) and (not(pe.imports('kernel32.dll', 'lstrcatA'))) and (pe.imports('ws2_32.dll', 'ntohl') or pe.imports('wsock32.dll', 'ntohl') or pe.imports('ws2', 'ntohl'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError') or pe.imports('rtmpal.dll', 'SetLastError') or pe.imports('kernelbase.dll', 'SetLastError')) and (pe.imports('kernel32.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW') or pe.imports('rtmpal.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW') or pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW')) and (not(pe.imports('kernel32.dll', 'LocalFileTimeToFileTime')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'LocalFileTimeToFileTime')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'LocalFileTimeToFileTime')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'LocalFileTimeToFileTime'))) and (pe.imports('kernel32.dll', 'RtlPcToFileHeader') or pe.imports('ntdll.dll', 'RtlPcToFileHeader') or pe.imports('api-ms-win-core-rtlsupport-l1-2-0.dll', 'RtlPcToFileHeader')))} drvnskm_rule rule_cluster_8{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError') or pe.imports('rtmpal.dll', 'SetLastError') or pe.imports('kernelbase.dll', 'SetLastError')) and (pe.imports('kernel32.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryW') or pe.imports('rtmpal.dll', 'LoadLibraryW') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'LoadLibraryW') or pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LoadLibraryW')) and (not(pe.imports('kernel32.dll', 'LocalFileTimeToFileTime')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'LocalFileTimeToFileTime')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'LocalFileTimeToFileTime')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'LocalFileTimeToFileTime'))) and (not(pe.imports('kernel32.dll', 'RtlPcToFileHeader')) and not(pe.imports('ntdll.dll', 'RtlPcToFileHeader')) and not(pe.imports('api-ms-win-core-rtlsupport-l1-2-0.dll', 'RtlPcToFileHeader'))))} drvnskm_rule rule_cluster_9{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('user32.dll', 'DestroyWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and (not(pe.imports('user32.dll', 'PeekMessageA'))) and (pe.imports('user32.dll', 'SetWindowPos') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'SetWindowPos')) and (not(pe.imports('msvcrt.dll', 'wcscmp')) and not(pe.imports('ntdll.dll', 'wcscmp')) and not(pe.imports('msvcr120.dll', 'wcscmp')) and not(pe.imports('ntoskrnl.exe', 'wcscmp')) and not(pe.imports('api-ms-win-crt-string-l1-1-0.dll', 'wcscmp')) and not(pe.imports('msvcrt40.dll', 'wcscmp')) and not(pe.imports('securekernel.exe', 'wcscmp')) and not(pe.imports('api-ms-win-core-crt-l1-1-0.dll', 'wcscmp'))))} drvnskm_rule rule_cluster_10{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('user32.dll', 'DestroyWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and (pe.imports('user32.dll', 'PeekMessageA')) and (not(pe.imports('advapi32.dll', 'RegDeleteKeyA')) and not(pe.imports('api-ms-win-core-registry-l2-2-0.dll', 'RegDeleteKeyA'))))} drvnskm_rule rule_cluster_11{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('user32.dll', 'DestroyWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and (pe.imports('user32.dll', 'PeekMessageA')) and (pe.imports('advapi32.dll', 'RegDeleteKeyA') or pe.imports('api-ms-win-core-registry-l2-2-0.dll', 'RegDeleteKeyA')) and (not(pe.imports('user32.dll', 'GetClassInfoExA'))))} drvnskm_rule rule_cluster_12{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (pe.imports('msvbvm60.dll', '__vbaFPException')) and (pe.imports('msvbvm60.dll', '__vbaLateMemCall')))} drvnskm_rule rule_cluster_13{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('user32.dll', 'DestroyWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and (pe.imports('user32.dll', 'PeekMessageA')) and (pe.imports('advapi32.dll', 'RegDeleteKeyA') or pe.imports('api-ms-win-core-registry-l2-2-0.dll', 'RegDeleteKeyA')) and (not(pe.imports('user32.dll', 'GetClassInfoExA'))))} drvnskm_rule rule_cluster_14{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (pe.imports('msvbvm60.dll', '__vbaFPException')) and (not(pe.imports('msvbvm60.dll', '__vbaLateMemCall'))) and (not(pe.imports('msvbvm60.dll', '__vbaStrCat'))))} drvnskm_rule rule_cluster_15{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (pe.imports('msvbvm60.dll', '__vbaFPException')) and (not(pe.imports('msvbvm60.dll', '__vbaLateMemCall'))) and (pe.imports('msvbvm60.dll', '__vbaStrCat')))} drvnskm_rule rule_cluster_16{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (not(pe.imports('msvbvm60.dll', '__vbaFPException'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('kernel32.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle'))) and (pe.imports('msacm32.dll', 'acmFilterEnumW')) and (pe.imports('kernel32.dll', 'VirtualProtect') or pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'VirtualProtect') or pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'VirtualProtect') or pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'VirtualProtect') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'VirtualProtect') or pe.imports('rtmpal.dll', 'VirtualProtect')))} drvnskm_rule rule_cluster_16{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (not(pe.imports('msvbvm60.dll', '__vbaFPException'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('kernel32.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle'))) and (pe.imports('msacm32.dll', 'acmFilterEnumW')) and (pe.imports('kernel32.dll', 'VirtualProtect') or pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'VirtualProtect') or pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'VirtualProtect') or pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'VirtualProtect') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'VirtualProtect') or pe.imports('rtmpal.dll', 'VirtualProtect'))) or ((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (not(pe.imports('msvbvm60.dll', '__vbaFPException'))) and (pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (pe.imports('oleaut32.dll', 'VarBstrFromI4')))} drvnskm_rule rule_cluster_17{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (not(pe.imports('msvbvm60.dll', '__vbaFPException'))) and (pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (pe.imports('oleaut32.dll', 'VarBstrFromI4')))} drvnskm_rule rule_cluster_18{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (not(pe.imports('msvbvm60.dll', '__vbaFPException'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('kernel32.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle'))) and (pe.imports('msacm32.dll', 'acmFilterEnumW')) and (not(pe.imports('kernel32.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'VirtualProtect')) and not(pe.imports('rtmpal.dll', 'VirtualProtect'))))} drvnskm_rule rule_cluster_18{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (not(pe.imports('msvbvm60.dll', '__vbaFPException'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('kernel32.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle'))) and (pe.imports('msacm32.dll', 'acmFilterEnumW')) and (not(pe.imports('kernel32.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'VirtualProtect')) and not(pe.imports('rtmpal.dll', 'VirtualProtect')))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (not(pe.imports('kernel32.dll', 'SetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError')) and not(pe.imports('rtmpal.dll', 'SetLastError')) and not(pe.imports('kernelbase.dll', 'SetLastError'))) and (not(pe.imports('kernel32.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('kernelbase.dll', 'SetUnhandledExceptionFilter')) and not(pe.imports('rtmpal.dll', 'SetUnhandledExceptionFilter'))) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA')) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))))} drvnskm_rule rule_cluster_19{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetTickCount')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTickCount')) and not(pe.imports('kernelbase.dll', 'GetTickCount')) and not(pe.imports('rtmpal.dll', 'GetTickCount'))) and (not(pe.imports('msvbvm60.dll', '__vbaFPException'))) and (not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (pe.imports('kernel32.dll', 'GetStdHandle') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle')) and (not(pe.imports('kernel32.dll', 'CreateDirectoryW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateDirectoryW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateDirectoryW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateDirectoryW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateDirectoryW'))))} drvnskm_rule rule_cluster_20{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow'))) and (not(pe.imports('kernel32.dll', 'SetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetLastError')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetLastError')) and not(pe.imports('rtmpal.dll', 'SetLastError')) and not(pe.imports('kernelbase.dll', 'SetLastError'))) and (pe.imports('kernel32.dll', 'SetUnhandledExceptionFilter') or pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'SetUnhandledExceptionFilter') or pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'SetUnhandledExceptionFilter') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetUnhandledExceptionFilter') or pe.imports('kernelbase.dll', 'SetUnhandledExceptionFilter') or pe.imports('rtmpal.dll', 'SetUnhandledExceptionFilter')) and (not(pe.imports('api-ms-win-core-com-l1-1-1.dll', 'CoGetClassObject')) and not(pe.imports('ole32.dll', 'CoGetClassObject')) and not(pe.imports('api-ms-win-core-com-l1-1-0.dll', 'CoGetClassObject'))))}