drvnskm_rule rule_cluster_0{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('user32.dll', 'GetSystemMetrics') or pe.imports('api-ms-win-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics') or pe.imports('ext-ms-win-rtcore-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics')) and (pe.imports('comctl32.dll', 'ImageList_Destroy')) and (not(pe.imports('user32.dll', 'DialogBoxParamA'))))} drvnskm_rule rule_cluster_1{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('user32.dll', 'GetSystemMetrics') or pe.imports('api-ms-win-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics') or pe.imports('ext-ms-win-rtcore-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics')) and (pe.imports('comctl32.dll', 'ImageList_Destroy')) and (pe.imports('user32.dll', 'DialogBoxParamA')))} drvnskm_rule rule_cluster_2{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'GetSystemMetrics')) and not(pe.imports('api-ms-win-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics')) and not(pe.imports('ext-ms-win-rtcore-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics'))) and (not(pe.imports('kernel32.dll', 'RtlLookupFunctionEntry')) and not(pe.imports('api-ms-win-core-rtlsupport-l1-2-0.dll', 'RtlLookupFunctionEntry')) and not(pe.imports('ntdll.dll', 'RtlLookupFunctionEntry')) and not(pe.imports('api-ms-win-core-rtlsupport-l1-1-0.dll', 'RtlLookupFunctionEntry'))) and (not(pe.imports('shell32.dll', 'DragQueryFileA'))) and (not(pe.imports('kernel32.dll', 'FindResourceA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'FindResourceA'))) and (pe.imports('kernel32.dll', 'GetProfileSectionA')))} drvnskm_rule rule_cluster_2{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'GetSystemMetrics')) and not(pe.imports('api-ms-win-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics')) and not(pe.imports('ext-ms-win-rtcore-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics'))) and (not(pe.imports('kernel32.dll', 'RtlLookupFunctionEntry')) and not(pe.imports('api-ms-win-core-rtlsupport-l1-2-0.dll', 'RtlLookupFunctionEntry')) and not(pe.imports('ntdll.dll', 'RtlLookupFunctionEntry')) and not(pe.imports('api-ms-win-core-rtlsupport-l1-1-0.dll', 'RtlLookupFunctionEntry'))) and (not(pe.imports('shell32.dll', 'DragQueryFileA'))) and (not(pe.imports('kernel32.dll', 'FindResourceA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'FindResourceA'))) and (pe.imports('kernel32.dll', 'GetProfileSectionA'))) or ((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'GetSystemMetrics')) and not(pe.imports('api-ms-win-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics')) and not(pe.imports('ext-ms-win-rtcore-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics'))) and (not(pe.imports('kernel32.dll', 'RtlLookupFunctionEntry')) and not(pe.imports('api-ms-win-core-rtlsupport-l1-2-0.dll', 'RtlLookupFunctionEntry')) and not(pe.imports('ntdll.dll', 'RtlLookupFunctionEntry')) and not(pe.imports('api-ms-win-core-rtlsupport-l1-1-0.dll', 'RtlLookupFunctionEntry'))) and (not(pe.imports('shell32.dll', 'DragQueryFileA'))) and (pe.imports('kernel32.dll', 'FindResourceA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-1.dll', 'FindResourceA')))} drvnskm_rule rule_cluster_3{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('user32.dll', 'GetSystemMetrics') or pe.imports('api-ms-win-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics') or pe.imports('ext-ms-win-rtcore-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics')) and (not(pe.imports('comctl32.dll', 'ImageList_Destroy'))))} drvnskm_rule rule_cluster_4{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (not(pe.imports('msvbvm60.dll', '__vbaExceptHandler'))) and (pe.imports('msvcrt.dll', '__p__fmode')))} drvnskm_rule rule_cluster_5{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')))} drvnskm_rule rule_cluster_6{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (pe.imports('msvbvm60.dll', '__vbaExceptHandler')))} drvnskm_rule rule_cluster_8{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'GetSystemMetrics')) and not(pe.imports('api-ms-win-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics')) and not(pe.imports('ext-ms-win-rtcore-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics'))) and (pe.imports('kernel32.dll', 'RtlLookupFunctionEntry') or pe.imports('api-ms-win-core-rtlsupport-l1-2-0.dll', 'RtlLookupFunctionEntry') or pe.imports('ntdll.dll', 'RtlLookupFunctionEntry') or pe.imports('api-ms-win-core-rtlsupport-l1-1-0.dll', 'RtlLookupFunctionEntry')) and (pe.imports('kernel32.dll', 'GetConsoleOutputCP') or pe.imports('api-ms-win-core-console-l1-1-0.dll', 'GetConsoleOutputCP') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetConsoleOutputCP')))} drvnskm_rule rule_cluster_9{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'GetSystemMetrics')) and not(pe.imports('api-ms-win-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics')) and not(pe.imports('ext-ms-win-rtcore-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics'))) and (pe.imports('kernel32.dll', 'RtlLookupFunctionEntry') or pe.imports('api-ms-win-core-rtlsupport-l1-2-0.dll', 'RtlLookupFunctionEntry') or pe.imports('ntdll.dll', 'RtlLookupFunctionEntry') or pe.imports('api-ms-win-core-rtlsupport-l1-1-0.dll', 'RtlLookupFunctionEntry')) and (not(pe.imports('kernel32.dll', 'GetConsoleOutputCP')) and not(pe.imports('api-ms-win-core-console-l1-1-0.dll', 'GetConsoleOutputCP')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetConsoleOutputCP'))) and (not(pe.imports('oleaut32.dll', 'LoadRegTypeLib'))))} drvnskm_rule rule_cluster_10{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'GetSystemMetrics')) and not(pe.imports('api-ms-win-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics')) and not(pe.imports('ext-ms-win-rtcore-ntuser-sysparams-l1-1-0.dll', 'GetSystemMetrics'))) and (not(pe.imports('kernel32.dll', 'RtlLookupFunctionEntry')) and not(pe.imports('api-ms-win-core-rtlsupport-l1-2-0.dll', 'RtlLookupFunctionEntry')) and not(pe.imports('ntdll.dll', 'RtlLookupFunctionEntry')) and not(pe.imports('api-ms-win-core-rtlsupport-l1-1-0.dll', 'RtlLookupFunctionEntry'))) and (pe.imports('shell32.dll', 'DragQueryFileA')))}