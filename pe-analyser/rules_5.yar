drvnskm_rule rule_cluster_0{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (pe.imports('msvbvm60.dll', '_adj_fptan')) and (pe.imports('msvbvm60.dll', '__vbaAryDestruct')))} drvnskm_rule rule_cluster_1{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (pe.imports('msvbvm60.dll', '_adj_fptan')) and (not(pe.imports('msvbvm60.dll', '__vbaAryDestruct'))))} drvnskm_rule rule_cluster_2{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (pe.imports('user32.dll', 'SystemParametersInfoA')) and (not(pe.imports('user32.dll', 'GetDlgItem'))) and (not(pe.imports('gdi32.dll', 'SetEnhMetaFileBits'))))} drvnskm_rule rule_cluster_2{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (pe.imports('user32.dll', 'SystemParametersInfoA')) and (not(pe.imports('user32.dll', 'GetDlgItem'))) and (not(pe.imports('gdi32.dll', 'SetEnhMetaFileBits')))) or ((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (pe.imports('user32.dll', 'SystemParametersInfoA')) and (not(pe.imports('user32.dll', 'GetDlgItem'))) and (pe.imports('gdi32.dll', 'SetEnhMetaFileBits')) and (not(pe.imports('comctl32.dll', 'ImageList_SetImageCount'))))} drvnskm_rule rule_cluster_3{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (pe.imports('user32.dll', 'SystemParametersInfoA')) and (not(pe.imports('user32.dll', 'GetDlgItem'))) and (pe.imports('gdi32.dll', 'SetEnhMetaFileBits')) and (pe.imports('comctl32.dll', 'ImageList_SetImageCount')))} drvnskm_rule rule_cluster_4{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (pe.imports('user32.dll', 'SystemParametersInfoA')) and (pe.imports('user32.dll', 'GetDlgItem')) and (not(pe.imports('gdi32.dll', 'SetPixel'))))} drvnskm_rule rule_cluster_5{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA')) and (pe.imports('comctl32.dll', 'ImageList_Create')) and (not(pe.imports('user32.dll', 'IsIconic'))))} drvnskm_rule rule_cluster_5{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA')) and (pe.imports('comctl32.dll', 'ImageList_Create')) and (not(pe.imports('user32.dll', 'IsIconic')))) or ((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA')) and (pe.imports('comctl32.dll', 'ImageList_Create')) and (pe.imports('user32.dll', 'IsIconic')))} drvnskm_rule rule_cluster_6{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA')) and (pe.imports('comctl32.dll', 'ImageList_Create')) and (not(pe.imports('user32.dll', 'IsIconic'))))} drvnskm_rule rule_cluster_7{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SystemParametersInfoA'))) and (not(pe.imports('kernel32.dll', 'InterlockedExchange')) and not(pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedExchange'))) and (pe.imports('kernel32.dll', 'DeleteFileW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'DeleteFileW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'DeleteFileW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'DeleteFileW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DeleteFileW')) and (not(pe.imports('kernel32.dll', 'LocalAlloc')) and not(pe.imports('api-ms-win-core-heap-l2-1-0.dll', 'LocalAlloc')) and not(pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'LocalAlloc')) and not(pe.imports('kernelbase.dll', 'LocalAlloc')) and not(pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LocalAlloc')) and not(pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'LocalAlloc'))))} drvnskm_rule rule_cluster_8{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (not(pe.imports('msvbvm60.dll', '_adj_fptan'))) and (not(pe.imports('user32.dll', 'RegisterClassA'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA')) and not(pe.imports('kernel32', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA'))) and (pe.imports('comctl32.dll', 'InitCommonControls')))} drvnskm_rule rule_cluster_8{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (not(pe.imports('msvbvm60.dll', '_adj_fptan'))) and (not(pe.imports('user32.dll', 'RegisterClassA'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA')) and not(pe.imports('kernel32', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA'))) and (pe.imports('comctl32.dll', 'InitCommonControls'))) or ((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (not(pe.imports('msvbvm60.dll', '_adj_fptan'))) and (not(pe.imports('user32.dll', 'RegisterClassA'))) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA')))} drvnskm_rule rule_cluster_9{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA')) and not(pe.imports('kernel32', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA'))))} drvnskm_rule rule_cluster_10{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA')) and (not(pe.imports('comctl32.dll', 'ImageList_Create'))))} drvnskm_rule rule_cluster_11{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter')) and not(pe.imports('kernelbase.dll', 'QueryPerformanceCounter')) and not(pe.imports('rtmpal.dll', 'QueryPerformanceCounter'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (not(pe.imports('msvbvm60.dll', '_adj_fptan'))) and (pe.imports('user32.dll', 'RegisterClassA')))} drvnskm_rule rule_cluster_12{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SystemParametersInfoA'))) and (not(pe.imports('kernel32.dll', 'InterlockedExchange')) and not(pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedExchange'))) and (pe.imports('kernel32.dll', 'DeleteFileW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'DeleteFileW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'DeleteFileW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'DeleteFileW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DeleteFileW')) and (pe.imports('kernel32.dll', 'LocalAlloc') or pe.imports('api-ms-win-core-heap-l2-1-0.dll', 'LocalAlloc') or pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'LocalAlloc') or pe.imports('kernelbase.dll', 'LocalAlloc') or pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LocalAlloc') or pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'LocalAlloc')) and (not(pe.imports('msvcr120_clr0400.dll', 'tolower')) and not(pe.imports('msvcrt.dll', 'tolower')) and not(pe.imports('api-ms-win-crt-string-l1-1-0.dll', 'tolower')) and not(pe.imports('ntdll.dll', 'tolower')) and not(pe.imports('ntoskrnl.exe', 'tolower')) and not(pe.imports('msvcr80.dll', 'tolower')) and not(pe.imports('msvcr90.dll', 'tolower'))))} drvnskm_rule rule_cluster_12{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SystemParametersInfoA'))) and (not(pe.imports('kernel32.dll', 'InterlockedExchange')) and not(pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedExchange'))) and (pe.imports('kernel32.dll', 'DeleteFileW') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'DeleteFileW') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'DeleteFileW') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'DeleteFileW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DeleteFileW')) and (pe.imports('kernel32.dll', 'LocalAlloc') or pe.imports('api-ms-win-core-heap-l2-1-0.dll', 'LocalAlloc') or pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'LocalAlloc') or pe.imports('kernelbase.dll', 'LocalAlloc') or pe.imports('api-ms-win-downlevel-kernel32-l2-1-0.dll', 'LocalAlloc') or pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'LocalAlloc')) and (not(pe.imports('msvcr120_clr0400.dll', 'tolower')) and not(pe.imports('msvcrt.dll', 'tolower')) and not(pe.imports('api-ms-win-crt-string-l1-1-0.dll', 'tolower')) and not(pe.imports('ntdll.dll', 'tolower')) and not(pe.imports('ntoskrnl.exe', 'tolower')) and not(pe.imports('msvcr80.dll', 'tolower')) and not(pe.imports('msvcr90.dll', 'tolower')))) or ((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SystemParametersInfoA'))) and (pe.imports('kernel32.dll', 'InterlockedExchange') or pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedExchange')) and (pe.imports('user32.dll', 'MsgWaitForMultipleObjects') or pe.imports('api-ms-win-rtcore-ntuser-synch-l1-1-0.dll', 'MsgWaitForMultipleObjects')))} drvnskm_rule rule_cluster_13{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SystemParametersInfoA'))) and (not(pe.imports('kernel32.dll', 'InterlockedExchange')) and not(pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedExchange'))) and (not(pe.imports('kernel32.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DeleteFileW'))) and (not(pe.imports('kernel32.dll', 'GlobalAlloc')) and not(pe.imports('api-ms-win-core-heap-l2-1-0.dll', 'GlobalAlloc')) and not(pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'GlobalAlloc')) and not(pe.imports('kernelbase.dll', 'GlobalAlloc'))) and (not(pe.imports('kernel32.dll', 'CreateFileA')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileA')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileA')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileA'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcessId')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcessId'))))} drvnskm_rule rule_cluster_13{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SystemParametersInfoA'))) and (not(pe.imports('kernel32.dll', 'InterlockedExchange')) and not(pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedExchange'))) and (not(pe.imports('kernel32.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DeleteFileW'))) and (not(pe.imports('kernel32.dll', 'GlobalAlloc')) and not(pe.imports('api-ms-win-core-heap-l2-1-0.dll', 'GlobalAlloc')) and not(pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'GlobalAlloc')) and not(pe.imports('kernelbase.dll', 'GlobalAlloc'))) and (not(pe.imports('kernel32.dll', 'CreateFileA')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileA')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileA')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileA'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcessId')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcessId')))) or ((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SystemParametersInfoA'))) and (not(pe.imports('kernel32.dll', 'InterlockedExchange')) and not(pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedExchange'))) and (not(pe.imports('kernel32.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DeleteFileW'))) and (not(pe.imports('kernel32.dll', 'GlobalAlloc')) and not(pe.imports('api-ms-win-core-heap-l2-1-0.dll', 'GlobalAlloc')) and not(pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'GlobalAlloc')) and not(pe.imports('kernelbase.dll', 'GlobalAlloc'))) and (not(pe.imports('kernel32.dll', 'CreateFileA')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'CreateFileA')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'CreateFileA')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'CreateFileA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CreateFileA'))) and (pe.imports('kernel32.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId') or pe.imports('kernelbase.dll', 'GetCurrentProcessId') or pe.imports('rtmpal.dll', 'GetCurrentProcessId')) and (pe.imports('kernel32.dll', 'FindClose') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'FindClose') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'FindClose') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'FindClose') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'FindClose')))} drvnskm_rule rule_cluster_14{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SystemParametersInfoA'))) and (not(pe.imports('kernel32.dll', 'InterlockedExchange')) and not(pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedExchange'))) and (not(pe.imports('kernel32.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'DeleteFileW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DeleteFileW'))) and (pe.imports('kernel32.dll', 'GlobalAlloc') or pe.imports('api-ms-win-core-heap-l2-1-0.dll', 'GlobalAlloc') or pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'GlobalAlloc') or pe.imports('kernelbase.dll', 'GlobalAlloc')))} drvnskm_rule rule_cluster_15{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SystemParametersInfoA'))) and (pe.imports('kernel32.dll', 'InterlockedExchange') or pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedExchange')) and (not(pe.imports('user32.dll', 'MsgWaitForMultipleObjects')) and not(pe.imports('api-ms-win-rtcore-ntuser-synch-l1-1-0.dll', 'MsgWaitForMultipleObjects'))))}