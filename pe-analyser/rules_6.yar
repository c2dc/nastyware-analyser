drvnskm_rule rule_cluster_0{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '_adj_fpatan'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (pe.imports('kernel32.dll', 'ExpandEnvironmentStringsA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'ExpandEnvironmentStringsA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'ExpandEnvironmentStringsA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExpandEnvironmentStringsA')))} drvnskm_rule rule_cluster_1{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SetWindowTextA'))) and (pe.imports('kernel32.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'ReadFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'ReadFile')) and (not(pe.imports('kernel32.dll', 'GetSystemDirectoryW')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemDirectoryW')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemDirectoryW')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemDirectoryW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemDirectoryW'))) and (pe.imports('kernel32.dll', 'SetConsoleMode') or pe.imports('api-ms-win-core-console-l1-1-0.dll', 'SetConsoleMode') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetConsoleMode')))} drvnskm_rule rule_cluster_2{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (pe.imports('msvbvm60.dll', '_adj_fpatan')) and (not(pe.imports('msvbvm60.dll', '__vbaRecAnsiToUni'))))} drvnskm_rule rule_cluster_3{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '_adj_fpatan'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('kernel32.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExpandEnvironmentStringsA'))) and (not(pe.imports('kernel32.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('rtmpal.dll', 'CloseHandle')) and not(pe.imports('kernelbase.dll', 'CloseHandle'))) and (not(pe.imports('comctl32.dll', 'InitCommonControls'))) and (pe.imports('advapi32.dll', 'ReportEventA') or pe.imports('api-ms-win-eventlog-legacy-l1-1-0.dll', 'ReportEventA')))} drvnskm_rule rule_cluster_3{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '_adj_fpatan'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('kernel32.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExpandEnvironmentStringsA'))) and (not(pe.imports('kernel32.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('rtmpal.dll', 'CloseHandle')) and not(pe.imports('kernelbase.dll', 'CloseHandle'))) and (not(pe.imports('comctl32.dll', 'InitCommonControls'))) and (pe.imports('advapi32.dll', 'ReportEventA') or pe.imports('api-ms-win-eventlog-legacy-l1-1-0.dll', 'ReportEventA'))) or ((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '_adj_fpatan'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('kernel32.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExpandEnvironmentStringsA'))) and (not(pe.imports('kernel32.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('rtmpal.dll', 'CloseHandle')) and not(pe.imports('kernelbase.dll', 'CloseHandle'))) and (pe.imports('comctl32.dll', 'InitCommonControls')))} drvnskm_rule rule_cluster_4{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '_adj_fpatan'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('kernel32.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExpandEnvironmentStringsA'))) and (not(pe.imports('kernel32.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('rtmpal.dll', 'CloseHandle')) and not(pe.imports('kernelbase.dll', 'CloseHandle'))) and (not(pe.imports('comctl32.dll', 'InitCommonControls'))) and (not(pe.imports('advapi32.dll', 'ReportEventA')) and not(pe.imports('api-ms-win-eventlog-legacy-l1-1-0.dll', 'ReportEventA'))))} drvnskm_rule rule_cluster_5{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (pe.imports('msvbvm60.dll', '_adj_fpatan')) and (pe.imports('msvbvm60.dll', '__vbaRecAnsiToUni')))} drvnskm_rule rule_cluster_7{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '_adj_fpatan'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('kernel32.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExpandEnvironmentStringsA'))) and (pe.imports('kernel32.dll', 'CloseHandle') or pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle') or pe.imports('rtmpal.dll', 'CloseHandle') or pe.imports('kernelbase.dll', 'CloseHandle')))} drvnskm_rule rule_cluster_7{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '_adj_fpatan'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('kernel32.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'ExpandEnvironmentStringsA')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExpandEnvironmentStringsA'))) and (pe.imports('kernel32.dll', 'CloseHandle') or pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle') or pe.imports('rtmpal.dll', 'CloseHandle') or pe.imports('kernelbase.dll', 'CloseHandle'))) or ((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SetWindowTextA'))) and (pe.imports('kernel32.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'ReadFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ReadFile') or pe.imports('api-ms-win-core-file-l1-2-0.dll', 'ReadFile')) and (not(pe.imports('kernel32.dll', 'GetSystemDirectoryW')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemDirectoryW')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemDirectoryW')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemDirectoryW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemDirectoryW'))) and (not(pe.imports('kernel32.dll', 'SetConsoleMode')) and not(pe.imports('api-ms-win-core-console-l1-1-0.dll', 'SetConsoleMode')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'SetConsoleMode'))) and (not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'GetTempFileNameW')) and not(pe.imports('kernel32.dll', 'GetTempFileNameW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetTempFileNameW')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'GetTempFileNameW')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'GetTempFileNameW'))))} drvnskm_rule rule_cluster_8{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SetWindowTextA'))) and (not(pe.imports('kernel32.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'ReadFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'ReadFile'))) and (not(pe.imports('kernel32.dll', 'SetHandleCount'))))} drvnskm_rule rule_cluster_9{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (not(pe.imports('user32.dll', 'SetWindowTextA'))) and (not(pe.imports('kernel32.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'ReadFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ReadFile')) and not(pe.imports('api-ms-win-core-file-l1-2-0.dll', 'ReadFile'))) and (pe.imports('kernel32.dll', 'SetHandleCount')) and (pe.imports('kernel32.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-core-profile-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'QueryPerformanceCounter') or pe.imports('kernelbase.dll', 'QueryPerformanceCounter') or pe.imports('rtmpal.dll', 'QueryPerformanceCounter')))} drvnskm_rule rule_cluster_10{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (pe.imports('user32.dll', 'SetWindowTextA')) and (not(pe.imports('comctl32.dll', 'ImageList_SetImageCount'))) and (not(pe.imports('crypt32.dll', 'CryptUnprotectData'))))} drvnskm_rule rule_cluster_11{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (pe.imports('user32.dll', 'SetWindowTextA')) and (pe.imports('comctl32.dll', 'ImageList_SetImageCount')) and (not(pe.imports('gdi32.dll', 'Ellipse'))))} drvnskm_rule rule_cluster_12{condition:((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (pe.imports('user32.dll', 'SetWindowTextA')) and (pe.imports('comctl32.dll', 'ImageList_SetImageCount')) and (pe.imports('gdi32.dll', 'Ellipse')))} drvnskm_rule rule_cluster_13{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '_adj_fpatan'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW') or pe.imports('rtmpal.dll', 'GetModuleHandleW') or pe.imports('kernelbase.dll', 'GetModuleHandleW')) and (pe.imports('user32.dll', 'EmptyClipboard') or pe.imports('api-ms-win-rtcore-ntuser-clipboard-l1-1-0.dll', 'EmptyClipboard')))} drvnskm_rule rule_cluster_13{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '_adj_fpatan'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW') or pe.imports('rtmpal.dll', 'GetModuleHandleW') or pe.imports('kernelbase.dll', 'GetModuleHandleW')) and (pe.imports('user32.dll', 'EmptyClipboard') or pe.imports('api-ms-win-rtcore-ntuser-clipboard-l1-1-0.dll', 'EmptyClipboard'))) or ((pe.imports('kernel32.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo')) and (pe.imports('user32.dll', 'SetWindowTextA')) and (not(pe.imports('comctl32.dll', 'ImageList_SetImageCount'))) and (pe.imports('crypt32.dll', 'CryptUnprotectData')))} drvnskm_rule rule_cluster_14{condition:((not(pe.imports('kernel32.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'GetCPInfo')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCPInfo'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '_adj_fpatan'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (pe.imports('kernel32.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleA') or pe.imports('kernel32', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleA') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleA')) and (pe.imports('kernel32.dll', 'EnumLanguageGroupLocalesW') or pe.imports('kernelbase.dll', 'EnumLanguageGroupLocalesW')))}