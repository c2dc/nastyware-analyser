drvnskm_rule rule_cluster_0{condition:((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (not(pe.imports('user32.dll', 'LoadIconA'))) and (pe.imports('kernel32.dll', 'GetCurrentProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcess') or pe.imports('kernelbase.dll', 'GetCurrentProcess') or pe.imports('rtmpal.dll', 'GetCurrentProcess')) and (pe.imports('kernel32.dll', 'SetEnvironmentVariableA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'SetEnvironmentVariableA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'SetEnvironmentVariableA')) and (not(pe.imports('kernel32.dll', 'GetExitCodeProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetExitCodeProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetExitCodeProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetExitCodeProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetExitCodeProcess'))) and (pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')))} drvnskm_rule rule_cluster_1{condition:((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (not(pe.imports('user32.dll', 'LoadIconA'))) and (pe.imports('kernel32.dll', 'GetCurrentProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcess') or pe.imports('kernelbase.dll', 'GetCurrentProcess') or pe.imports('rtmpal.dll', 'GetCurrentProcess')) and (pe.imports('kernel32.dll', 'SetEnvironmentVariableA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'SetEnvironmentVariableA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'SetEnvironmentVariableA')) and (not(pe.imports('kernel32.dll', 'GetExitCodeProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetExitCodeProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetExitCodeProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetExitCodeProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetExitCodeProcess'))) and (not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))))} drvnskm_rule rule_cluster_2{condition:((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (not(pe.imports('user32.dll', 'LoadIconA'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcess')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcess'))) and (not(pe.imports('kernel32.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('rtmpal.dll', 'CloseHandle')) and not(pe.imports('kernelbase.dll', 'CloseHandle'))) and (pe.imports('kernel32.dll', 'lstrcmpA') or pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpA')))} drvnskm_rule rule_cluster_3{condition:((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (not(pe.imports('user32.dll', 'LoadIconA'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcess')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcess'))) and (not(pe.imports('kernel32.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('rtmpal.dll', 'CloseHandle')) and not(pe.imports('kernelbase.dll', 'CloseHandle'))) and (not(pe.imports('kernel32.dll', 'lstrcmpA')) and not(pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpA'))) and (not(pe.imports('secur32.dll', 'GetUserNameExW')) and not(pe.imports('sspicli.dll', 'GetUserNameExW'))) and (pe.imports('gdi32.dll', 'RealizePalette')))} drvnskm_rule rule_cluster_3{condition:((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (not(pe.imports('user32.dll', 'LoadIconA'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcess')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcess'))) and (not(pe.imports('kernel32.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('rtmpal.dll', 'CloseHandle')) and not(pe.imports('kernelbase.dll', 'CloseHandle'))) and (not(pe.imports('kernel32.dll', 'lstrcmpA')) and not(pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpA'))) and (not(pe.imports('secur32.dll', 'GetUserNameExW')) and not(pe.imports('sspicli.dll', 'GetUserNameExW'))) and (pe.imports('gdi32.dll', 'RealizePalette'))) or ((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (not(pe.imports('user32.dll', 'LoadIconA'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcess')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcess'))) and (not(pe.imports('kernel32.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('rtmpal.dll', 'CloseHandle')) and not(pe.imports('kernelbase.dll', 'CloseHandle'))) and (not(pe.imports('kernel32.dll', 'lstrcmpA')) and not(pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpA'))) and (pe.imports('secur32.dll', 'GetUserNameExW') or pe.imports('sspicli.dll', 'GetUserNameExW')))} drvnskm_rule rule_cluster_3{condition:((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (not(pe.imports('user32.dll', 'LoadIconA'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcess')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcess'))) and (not(pe.imports('kernel32.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('rtmpal.dll', 'CloseHandle')) and not(pe.imports('kernelbase.dll', 'CloseHandle'))) and (not(pe.imports('kernel32.dll', 'lstrcmpA')) and not(pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpA'))) and (not(pe.imports('secur32.dll', 'GetUserNameExW')) and not(pe.imports('sspicli.dll', 'GetUserNameExW'))) and (pe.imports('gdi32.dll', 'RealizePalette'))) or ((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (not(pe.imports('user32.dll', 'LoadIconA'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcess')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcess'))) and (not(pe.imports('kernel32.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle')) and not(pe.imports('rtmpal.dll', 'CloseHandle')) and not(pe.imports('kernelbase.dll', 'CloseHandle'))) and (not(pe.imports('kernel32.dll', 'lstrcmpA')) and not(pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpA'))) and (pe.imports('secur32.dll', 'GetUserNameExW') or pe.imports('sspicli.dll', 'GetUserNameExW'))) or ((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (pe.imports('user32.dll', 'LoadIconA')) and (not(pe.imports('kernel32.dll', 'lstrcmpiA')) and not(pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'lstrcmpiA')) and not(pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpiA')) and not(pe.imports('kernelbase.dll', 'lstrcmpiA'))) and (not(pe.imports('oleaut32.dll', 'VariantClear')) and not(pe.imports('rtmpal.dll', 'VariantClear'))) and (not(pe.imports('kernel32.dll', 'HeapCreate')) and not(pe.imports('api-ms-win-core-heap-l1-2-0.dll', 'HeapCreate')) and not(pe.imports('api-ms-win-core-heap-l1-1-0.dll', 'HeapCreate')) and not(pe.imports('rtmpal.dll', 'HeapCreate')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'HeapCreate'))) and (pe.imports('user32.dll', 'CloseWindow')))} drvnskm_rule rule_cluster_5{condition:((not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('msvbvm60.dll', '_CIexp')) and not(pe.imports('msvcrt.dll', '_CIexp')) and not(pe.imports('msvcr120_clr0400.dll', '_CIexp'))) and (pe.imports('kernel32.dll', 'GetConsoleMode') or pe.imports('api-ms-win-core-console-l1-1-0.dll', 'GetConsoleMode') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetConsoleMode')) and (not(pe.imports('kernel32.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW'))) and (pe.imports('kernel32.dll', 'TerminateThread') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'TerminateThread') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'TerminateThread')))} drvnskm_rule rule_cluster_5{condition:((not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('msvbvm60.dll', '_CIexp')) and not(pe.imports('msvcrt.dll', '_CIexp')) and not(pe.imports('msvcr120_clr0400.dll', '_CIexp'))) and (pe.imports('kernel32.dll', 'GetConsoleMode') or pe.imports('api-ms-win-core-console-l1-1-0.dll', 'GetConsoleMode') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetConsoleMode')) and (not(pe.imports('kernel32.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW'))) and (pe.imports('kernel32.dll', 'TerminateThread') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'TerminateThread') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'TerminateThread'))) or ((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (pe.imports('user32.dll', 'LoadIconA')) and (not(pe.imports('kernel32.dll', 'lstrcmpiA')) and not(pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'lstrcmpiA')) and not(pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpiA')) and not(pe.imports('kernelbase.dll', 'lstrcmpiA'))) and (not(pe.imports('oleaut32.dll', 'VariantClear')) and not(pe.imports('rtmpal.dll', 'VariantClear'))) and (not(pe.imports('kernel32.dll', 'HeapCreate')) and not(pe.imports('api-ms-win-core-heap-l1-2-0.dll', 'HeapCreate')) and not(pe.imports('api-ms-win-core-heap-l1-1-0.dll', 'HeapCreate')) and not(pe.imports('rtmpal.dll', 'HeapCreate')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'HeapCreate'))) and (not(pe.imports('user32.dll', 'CloseWindow'))))} drvnskm_rule rule_cluster_6{condition:((not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('msvbvm60.dll', '_CIexp')) and not(pe.imports('msvcrt.dll', '_CIexp')) and not(pe.imports('msvcr120_clr0400.dll', '_CIexp'))) and (pe.imports('kernel32.dll', 'GetConsoleMode') or pe.imports('api-ms-win-core-console-l1-1-0.dll', 'GetConsoleMode') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetConsoleMode')) and (pe.imports('kernel32.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW')) and (not(pe.imports('kernel32.dll', 'CompareStringW')) and not(pe.imports('api-ms-win-core-string-l1-1-0.dll', 'CompareStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CompareStringW'))) and (not(pe.imports('advapi32.dll', 'ControlService')) and not(pe.imports('api-ms-win-service-winsvc-l1-1-0.dll', 'ControlService')) and not(pe.imports('api-ms-win-service-winsvc-l1-2-0.dll', 'ControlService'))))} drvnskm_rule rule_cluster_7{condition:((not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('msvbvm60.dll', '_CIexp')) and not(pe.imports('msvcrt.dll', '_CIexp')) and not(pe.imports('msvcr120_clr0400.dll', '_CIexp'))) and (pe.imports('kernel32.dll', 'GetConsoleMode') or pe.imports('api-ms-win-core-console-l1-1-0.dll', 'GetConsoleMode') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetConsoleMode')) and (not(pe.imports('kernel32.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW'))) and (not(pe.imports('kernel32.dll', 'TerminateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'TerminateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'TerminateThread'))) and (pe.imports('oleaut32.dll', 'VarI4FromR4')))} drvnskm_rule rule_cluster_7{condition:((not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (not(pe.imports('msvbvm60.dll', '_CIexp')) and not(pe.imports('msvcrt.dll', '_CIexp')) and not(pe.imports('msvcr120_clr0400.dll', '_CIexp'))) and (pe.imports('kernel32.dll', 'GetConsoleMode') or pe.imports('api-ms-win-core-console-l1-1-0.dll', 'GetConsoleMode') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetConsoleMode')) and (not(pe.imports('kernel32.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-1.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-2-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-core-localization-l1-1-0.dll', 'LCMapStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'LCMapStringW'))) and (not(pe.imports('kernel32.dll', 'TerminateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'TerminateThread')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'TerminateThread'))) and (pe.imports('oleaut32.dll', 'VarI4FromR4'))) or ((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (not(pe.imports('user32.dll', 'LoadIconA'))) and (pe.imports('kernel32.dll', 'GetCurrentProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcess') or pe.imports('kernelbase.dll', 'GetCurrentProcess') or pe.imports('rtmpal.dll', 'GetCurrentProcess')) and (pe.imports('kernel32.dll', 'SetEnvironmentVariableA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'SetEnvironmentVariableA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'SetEnvironmentVariableA')) and (pe.imports('kernel32.dll', 'GetExitCodeProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetExitCodeProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetExitCodeProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetExitCodeProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetExitCodeProcess')) and (not(pe.imports('kernel32.dll', 'TlsGetValue')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'TlsGetValue')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'TlsGetValue')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'TlsGetValue')) and not(pe.imports('rtmpal.dll', 'TlsGetValue')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'TlsGetValue'))))} drvnskm_rule rule_cluster_8{condition:((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (pe.imports('user32.dll', 'LoadIconA')) and (not(pe.imports('kernel32.dll', 'lstrcmpiA')) and not(pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'lstrcmpiA')) and not(pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpiA')) and not(pe.imports('kernelbase.dll', 'lstrcmpiA'))) and (not(pe.imports('oleaut32.dll', 'VariantClear')) and not(pe.imports('rtmpal.dll', 'VariantClear'))) and (pe.imports('kernel32.dll', 'HeapCreate') or pe.imports('api-ms-win-core-heap-l1-2-0.dll', 'HeapCreate') or pe.imports('api-ms-win-core-heap-l1-1-0.dll', 'HeapCreate') or pe.imports('rtmpal.dll', 'HeapCreate') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'HeapCreate')))} drvnskm_rule rule_cluster_9{condition:((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (pe.imports('user32.dll', 'LoadIconA')) and (not(pe.imports('kernel32.dll', 'lstrcmpiA')) and not(pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'lstrcmpiA')) and not(pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpiA')) and not(pe.imports('kernelbase.dll', 'lstrcmpiA'))) and (pe.imports('oleaut32.dll', 'VariantClear') or pe.imports('rtmpal.dll', 'VariantClear')) and (pe.imports('kernel32.dll', 'GlobalSize') or pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'GlobalSize')))} drvnskm_rule rule_cluster_10{condition:((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (pe.imports('user32.dll', 'LoadIconA')) and (pe.imports('kernel32.dll', 'lstrcmpiA') or pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'lstrcmpiA') or pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpiA') or pe.imports('kernelbase.dll', 'lstrcmpiA')) and (not(pe.imports('kernel32.dll', 'GlobalHandle')) and not(pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'GlobalHandle'))))} drvnskm_rule rule_cluster_10{condition:((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (pe.imports('user32.dll', 'LoadIconA')) and (pe.imports('kernel32.dll', 'lstrcmpiA') or pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'lstrcmpiA') or pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpiA') or pe.imports('kernelbase.dll', 'lstrcmpiA')) and (not(pe.imports('kernel32.dll', 'GlobalHandle')) and not(pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'GlobalHandle')))) or ((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (pe.imports('user32.dll', 'LoadIconA')) and (pe.imports('kernel32.dll', 'lstrcmpiA') or pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'lstrcmpiA') or pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpiA') or pe.imports('kernelbase.dll', 'lstrcmpiA')) and (pe.imports('kernel32.dll', 'GlobalHandle') or pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'GlobalHandle')) and (pe.imports('kernel32.dll', '_lwrite') or pe.imports('api-ms-win-core-kernel32-private-l1-1-1.dll', '_lwrite')))} drvnskm_rule rule_cluster_11{condition:((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (pe.imports('user32.dll', 'LoadIconA')) and (pe.imports('kernel32.dll', 'lstrcmpiA') or pe.imports('api-ms-win-core-misc-l1-1-0.dll', 'lstrcmpiA') or pe.imports('api-ms-win-core-string-obsolete-l1-1-0.dll', 'lstrcmpiA') or pe.imports('kernelbase.dll', 'lstrcmpiA')) and (pe.imports('kernel32.dll', 'GlobalHandle') or pe.imports('api-ms-win-core-heap-obsolete-l1-1-0.dll', 'GlobalHandle')) and (not(pe.imports('kernel32.dll', '_lwrite')) and not(pe.imports('api-ms-win-core-kernel32-private-l1-1-1.dll', '_lwrite'))))} drvnskm_rule rule_cluster_12{condition:((not(pe.imports('kernel32.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA')) and not(pe.imports('rtmpal.dll', 'LoadLibraryA'))) and (pe.imports('msvbvm60.dll', '_CIexp') or pe.imports('msvcrt.dll', '_CIexp') or pe.imports('msvcr120_clr0400.dll', '_CIexp')))} drvnskm_rule rule_cluster_13{condition:((pe.imports('kernel32.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-2.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-kernel32-legacy-l1-1-0.dll', 'LoadLibraryA') or pe.imports('api-ms-win-core-libraryloader-l1-2-1.dll', 'LoadLibraryA') or pe.imports('rtmpal.dll', 'LoadLibraryA')) and (not(pe.imports('user32.dll', 'LoadIconA'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcess')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcess')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcess'))) and (pe.imports('kernel32.dll', 'CloseHandle') or pe.imports('api-ms-win-core-handle-l1-1-0.dll', 'CloseHandle') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'CloseHandle') or pe.imports('rtmpal.dll', 'CloseHandle') or pe.imports('kernelbase.dll', 'CloseHandle')) and (not(pe.imports('user32.dll', 'UnpackDDElParam'))))}