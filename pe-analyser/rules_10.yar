drvnskm_rule rule_cluster_0{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcessId')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcessId'))) and (pe.imports('kernel32.dll', 'GetStdHandle') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle')) and (pe.imports('kernel32.dll', 'OutputDebugStringW') or pe.imports('api-ms-win-core-debug-l1-1-1.dll', 'OutputDebugStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'OutputDebugStringW') or pe.imports('api-ms-win-core-debug-l1-1-0.dll', 'OutputDebugStringW') or pe.imports('kernelbase.dll', 'OutputDebugStringW')))} drvnskm_rule rule_cluster_0{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcessId')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcessId'))) and (pe.imports('kernel32.dll', 'GetStdHandle') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle')) and (pe.imports('kernel32.dll', 'OutputDebugStringW') or pe.imports('api-ms-win-core-debug-l1-1-1.dll', 'OutputDebugStringW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'OutputDebugStringW') or pe.imports('api-ms-win-core-debug-l1-1-0.dll', 'OutputDebugStringW') or pe.imports('kernelbase.dll', 'OutputDebugStringW'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId') or pe.imports('kernelbase.dll', 'GetCurrentProcessId') or pe.imports('rtmpal.dll', 'GetCurrentProcessId')) and (not(pe.imports('kernel32.dll', 'MapViewOfFile')) and not(pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'MapViewOfFile')) and not(pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'MapViewOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'MapViewOfFile')) and not(pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'MapViewOfFile')) and not(pe.imports('rtmpal.dll', 'MapViewOfFile'))) and (not(pe.imports('advapi32.dll', 'GetUserNameA'))) and (pe.imports('setupapi.dll', 'SetupDiClassNameFromGuidW')))} drvnskm_rule rule_cluster_1{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId') or pe.imports('kernelbase.dll', 'GetCurrentProcessId') or pe.imports('rtmpal.dll', 'GetCurrentProcessId')) and (pe.imports('kernel32.dll', 'MapViewOfFile') or pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'MapViewOfFile') or pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'MapViewOfFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'MapViewOfFile') or pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'MapViewOfFile') or pe.imports('rtmpal.dll', 'MapViewOfFile')) and (not(pe.imports('kernel32.dll', 'GetCurrentDirectoryA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCurrentDirectoryA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCurrentDirectoryA'))))} drvnskm_rule rule_cluster_2{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (pe.imports('msvbvm60.dll', '__vbaFreeVarList')))} drvnskm_rule rule_cluster_3{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '__vbaFreeVarList'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('crypt32.dll', 'CertGetCRLFromStore'))) and (not(pe.imports('ntoskrnl.exe', 'ExAllocatePoolWithTag'))) and (not(pe.imports('storport.sys', 'StorPortPause'))) and (not(pe.imports('ole32.dll', 'CoGetInterfaceAndReleaseStream')) and not(pe.imports('api-ms-win-core-com-l1-1-1.dll', 'CoGetInterfaceAndReleaseStream')) and not(pe.imports('api-ms-win-core-com-l1-1-0.dll', 'CoGetInterfaceAndReleaseStream'))))} drvnskm_rule rule_cluster_3{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '__vbaFreeVarList'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('crypt32.dll', 'CertGetCRLFromStore'))) and (not(pe.imports('ntoskrnl.exe', 'ExAllocatePoolWithTag'))) and (not(pe.imports('storport.sys', 'StorPortPause'))) and (not(pe.imports('ole32.dll', 'CoGetInterfaceAndReleaseStream')) and not(pe.imports('api-ms-win-core-com-l1-1-1.dll', 'CoGetInterfaceAndReleaseStream')) and not(pe.imports('api-ms-win-core-com-l1-1-0.dll', 'CoGetInterfaceAndReleaseStream')))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcessId')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcessId'))) and (not(pe.imports('kernel32.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle'))) and (not(pe.imports('gdi32.dll', 'StrokePath'))))} drvnskm_rule rule_cluster_4{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '__vbaFreeVarList'))) and (pe.imports('kernel32.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW') or pe.imports('rtmpal.dll', 'GetModuleHandleW') or pe.imports('kernelbase.dll', 'GetModuleHandleW')) and (pe.imports('gdi32.dll', 'RealizePalette')))} drvnskm_rule rule_cluster_5{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '__vbaFreeVarList'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('crypt32.dll', 'CertGetCRLFromStore'))) and (not(pe.imports('ntoskrnl.exe', 'ExAllocatePoolWithTag'))) and (not(pe.imports('storport.sys', 'StorPortPause'))) and (pe.imports('ole32.dll', 'CoGetInterfaceAndReleaseStream') or pe.imports('api-ms-win-core-com-l1-1-1.dll', 'CoGetInterfaceAndReleaseStream') or pe.imports('api-ms-win-core-com-l1-1-0.dll', 'CoGetInterfaceAndReleaseStream')))} drvnskm_rule rule_cluster_5{condition:((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '__vbaFreeVarList'))) and (not(pe.imports('kernel32.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW')) and not(pe.imports('rtmpal.dll', 'GetModuleHandleW')) and not(pe.imports('kernelbase.dll', 'GetModuleHandleW'))) and (not(pe.imports('crypt32.dll', 'CertGetCRLFromStore'))) and (not(pe.imports('ntoskrnl.exe', 'ExAllocatePoolWithTag'))) and (not(pe.imports('storport.sys', 'StorPortPause'))) and (pe.imports('ole32.dll', 'CoGetInterfaceAndReleaseStream') or pe.imports('api-ms-win-core-com-l1-1-1.dll', 'CoGetInterfaceAndReleaseStream') or pe.imports('api-ms-win-core-com-l1-1-0.dll', 'CoGetInterfaceAndReleaseStream'))) or ((not(pe.imports('kernel32.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess'))) and (not(pe.imports('kernel32.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-1.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-core-sysinfo-l1-2-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('kernelbase.dll', 'GetSystemTimeAsFileTime')) and not(pe.imports('rtmpal.dll', 'GetSystemTimeAsFileTime'))) and (not(pe.imports('msvbvm60.dll', '__vbaFreeVarList'))) and (pe.imports('kernel32.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetModuleHandleW') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetModuleHandleW') or pe.imports('rtmpal.dll', 'GetModuleHandleW') or pe.imports('kernelbase.dll', 'GetModuleHandleW')) and (not(pe.imports('gdi32.dll', 'RealizePalette'))))} drvnskm_rule rule_cluster_7{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId') or pe.imports('kernelbase.dll', 'GetCurrentProcessId') or pe.imports('rtmpal.dll', 'GetCurrentProcessId')) and (not(pe.imports('kernel32.dll', 'MapViewOfFile')) and not(pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'MapViewOfFile')) and not(pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'MapViewOfFile')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'MapViewOfFile')) and not(pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'MapViewOfFile')) and not(pe.imports('rtmpal.dll', 'MapViewOfFile'))) and (pe.imports('advapi32.dll', 'GetUserNameA')))} drvnskm_rule rule_cluster_8{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId') or pe.imports('kernelbase.dll', 'GetCurrentProcessId') or pe.imports('rtmpal.dll', 'GetCurrentProcessId')) and (pe.imports('kernel32.dll', 'MapViewOfFile') or pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'MapViewOfFile') or pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'MapViewOfFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'MapViewOfFile') or pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'MapViewOfFile') or pe.imports('rtmpal.dll', 'MapViewOfFile')) and (pe.imports('kernel32.dll', 'GetCurrentDirectoryA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCurrentDirectoryA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCurrentDirectoryA')))} drvnskm_rule rule_cluster_8{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow'))) and (pe.imports('kernel32.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId') or pe.imports('kernelbase.dll', 'GetCurrentProcessId') or pe.imports('rtmpal.dll', 'GetCurrentProcessId')) and (pe.imports('kernel32.dll', 'MapViewOfFile') or pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'MapViewOfFile') or pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'MapViewOfFile') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'MapViewOfFile') or pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'MapViewOfFile') or pe.imports('rtmpal.dll', 'MapViewOfFile')) and (pe.imports('kernel32.dll', 'GetCurrentDirectoryA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCurrentDirectoryA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCurrentDirectoryA'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('user32.dll', 'DestroyWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and (not(pe.imports('user32.dll', 'IntersectRect')) and not(pe.imports('api-ms-win-ntuser-rectangle-l1-1-0.dll', 'IntersectRect'))) and (pe.imports('oleaut32.dll', 'SysAllocString') or pe.imports('rtmpal.dll', 'SysAllocString')))} drvnskm_rule rule_cluster_9{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('user32.dll', 'DestroyWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and (not(pe.imports('user32.dll', 'IntersectRect')) and not(pe.imports('api-ms-win-ntuser-rectangle-l1-1-0.dll', 'IntersectRect'))) and (not(pe.imports('oleaut32.dll', 'SysAllocString')) and not(pe.imports('rtmpal.dll', 'SysAllocString'))))} drvnskm_rule rule_cluster_10{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('user32.dll', 'DestroyWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and (pe.imports('user32.dll', 'IntersectRect') or pe.imports('api-ms-win-ntuser-rectangle-l1-1-0.dll', 'IntersectRect')) and (pe.imports('user32.dll', 'MessageBeep')) and (not(pe.imports('user32.dll', 'LoadBitmapW'))))} drvnskm_rule rule_cluster_11{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('user32.dll', 'DestroyWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and (pe.imports('user32.dll', 'IntersectRect') or pe.imports('api-ms-win-ntuser-rectangle-l1-1-0.dll', 'IntersectRect')) and (not(pe.imports('user32.dll', 'MessageBeep'))))} drvnskm_rule rule_cluster_12{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcessId')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcessId'))) and (not(pe.imports('kernel32.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle'))) and (pe.imports('gdi32.dll', 'StrokePath')) and (pe.imports('gdi32.dll', 'SetWindowOrgEx')))} drvnskm_rule rule_cluster_12{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcessId')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcessId'))) and (not(pe.imports('kernel32.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle'))) and (pe.imports('gdi32.dll', 'StrokePath')) and (pe.imports('gdi32.dll', 'SetWindowOrgEx'))) or ((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (pe.imports('user32.dll', 'DestroyWindow') or pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow')) and (pe.imports('user32.dll', 'IntersectRect') or pe.imports('api-ms-win-ntuser-rectangle-l1-1-0.dll', 'IntersectRect')) and (pe.imports('user32.dll', 'MessageBeep')) and (pe.imports('user32.dll', 'LoadBitmapW')))} drvnskm_rule rule_cluster_13{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcessId')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcessId'))) and (pe.imports('kernel32.dll', 'GetStdHandle') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle')) and (not(pe.imports('kernel32.dll', 'OutputDebugStringW')) and not(pe.imports('api-ms-win-core-debug-l1-1-1.dll', 'OutputDebugStringW')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'OutputDebugStringW')) and not(pe.imports('api-ms-win-core-debug-l1-1-0.dll', 'OutputDebugStringW')) and not(pe.imports('kernelbase.dll', 'OutputDebugStringW'))))} drvnskm_rule rule_cluster_14{condition:((pe.imports('kernel32.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'ExitProcess') or pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'ExitProcess') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'ExitProcess')) and (not(pe.imports('user32.dll', 'DestroyWindow')) and not(pe.imports('ext-ms-win-rtcore-ntuser-window-ext-l1-1-0.dll', 'DestroyWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'DestroyWindow'))) and (not(pe.imports('kernel32.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-2.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-core-processthreads-l1-1-1.dll', 'GetCurrentProcessId')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetCurrentProcessId')) and not(pe.imports('kernelbase.dll', 'GetCurrentProcessId')) and not(pe.imports('rtmpal.dll', 'GetCurrentProcessId'))) and (not(pe.imports('kernel32.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetStdHandle')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetStdHandle'))) and (pe.imports('gdi32.dll', 'StrokePath')) and (not(pe.imports('gdi32.dll', 'SetWindowOrgEx'))))}