drvnskm_rule rule_cluster_0{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('msvcrt.dll', '_initterm')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', '_initterm')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', '_initterm')) and not(pe.imports('msvcr120_clr0400.dll', '_initterm')) and not(pe.imports('msvcr100.dll', '_initterm')) and not(pe.imports('msvcr120.dll', '_initterm')) and not(pe.imports('msvcr90.dll', '_initterm')) and not(pe.imports('msvcr80.dll', '_initterm')) and not(pe.imports('msvcrt40.dll', '_initterm'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (not(pe.imports('advapi32.dll', 'GetSidIdentifierAuthority')) and not(pe.imports('api-ms-win-security-base-l1-2-0.dll', 'GetSidIdentifierAuthority')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'GetSidIdentifierAuthority'))) and (not(pe.imports('crypt32.dll', 'CertGetCRLFromStore'))) and (pe.imports('winmm.dll', 'midiOutGetErrorTextA') or pe.imports('api-ms-win-mm-mme-l1-1-0.dll', 'midiOutGetErrorTextA')))} drvnskm_rule rule_cluster_0{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('msvcrt.dll', '_initterm')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', '_initterm')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', '_initterm')) and not(pe.imports('msvcr120_clr0400.dll', '_initterm')) and not(pe.imports('msvcr100.dll', '_initterm')) and not(pe.imports('msvcr120.dll', '_initterm')) and not(pe.imports('msvcr90.dll', '_initterm')) and not(pe.imports('msvcr80.dll', '_initterm')) and not(pe.imports('msvcrt40.dll', '_initterm'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (not(pe.imports('advapi32.dll', 'GetSidIdentifierAuthority')) and not(pe.imports('api-ms-win-security-base-l1-2-0.dll', 'GetSidIdentifierAuthority')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'GetSidIdentifierAuthority'))) and (not(pe.imports('crypt32.dll', 'CertGetCRLFromStore'))) and (pe.imports('winmm.dll', 'midiOutGetErrorTextA') or pe.imports('api-ms-win-mm-mme-l1-1-0.dll', 'midiOutGetErrorTextA'))) or ((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('msvcrt.dll', '_initterm')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', '_initterm')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', '_initterm')) and not(pe.imports('msvcr120_clr0400.dll', '_initterm')) and not(pe.imports('msvcr100.dll', '_initterm')) and not(pe.imports('msvcr120.dll', '_initterm')) and not(pe.imports('msvcr90.dll', '_initterm')) and not(pe.imports('msvcr80.dll', '_initterm')) and not(pe.imports('msvcrt40.dll', '_initterm'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (pe.imports('advapi32.dll', 'GetSidIdentifierAuthority') or pe.imports('api-ms-win-security-base-l1-2-0.dll', 'GetSidIdentifierAuthority') or pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'GetSidIdentifierAuthority')) and (not(pe.imports('crypt32.dll', 'CertStrToNameA'))))} drvnskm_rule rule_cluster_1{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('msvcrt.dll', '_initterm')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', '_initterm')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', '_initterm')) and not(pe.imports('msvcr120_clr0400.dll', '_initterm')) and not(pe.imports('msvcr100.dll', '_initterm')) and not(pe.imports('msvcr120.dll', '_initterm')) and not(pe.imports('msvcr90.dll', '_initterm')) and not(pe.imports('msvcr80.dll', '_initterm')) and not(pe.imports('msvcrt40.dll', '_initterm'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'GetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'GetLastError')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetLastError')) and not(pe.imports('rtmpal.dll', 'GetLastError')) and not(pe.imports('kernelbase.dll', 'GetLastError'))) and (not(pe.imports('kernel32.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'VirtualProtect')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'VirtualProtect')) and not(pe.imports('rtmpal.dll', 'VirtualProtect'))))} drvnskm_rule rule_cluster_2{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'DispatchMessageA'))) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject')) and (not(pe.imports('kernel32.dll', 'InterlockedFlushSList')) and not(pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedFlushSList')) and not(pe.imports('api-ms-win-core-interlocked-l1-1-0.dll', 'InterlockedFlushSList'))) and (not(pe.imports('msvcrt.dll', '__p__environ'))))} drvnskm_rule rule_cluster_3{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'DispatchMessageA'))) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (pe.imports('kernel32.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'InitializeCriticalSection') or pe.imports('rtmpal.dll', 'InitializeCriticalSection')) and (not(pe.imports('kernel32.dll', 'DecodePointer')) and not(pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer')) and not(pe.imports('rtmpal.dll', 'DecodePointer')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer')) and not(pe.imports('kernelbase.dll', 'DecodePointer'))) and (not(pe.imports('oleaut32.dll', 'LoadTypeLib'))))} drvnskm_rule rule_cluster_4{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'DispatchMessageA'))) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (pe.imports('kernel32.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'InitializeCriticalSection') or pe.imports('rtmpal.dll', 'InitializeCriticalSection')) and (pe.imports('kernel32.dll', 'DecodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer') or pe.imports('rtmpal.dll', 'DecodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer') or pe.imports('kernelbase.dll', 'DecodePointer')) and (not(pe.imports('advapi32.dll', 'RegEnumValueA')) and not(pe.imports('api-ms-win-core-registry-l1-1-0.dll', 'RegEnumValueA')) and not(pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'RegEnumValueA')) and not(pe.imports('kernel32.dll', 'RegEnumValueA'))))} drvnskm_rule rule_cluster_5{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'DispatchMessageA'))) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject')) and (pe.imports('kernel32.dll', 'InterlockedFlushSList') or pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedFlushSList') or pe.imports('api-ms-win-core-interlocked-l1-1-0.dll', 'InterlockedFlushSList')) and (not(pe.imports('kernel32.dll', 'SystemTimeToTzSpecificLocalTime')) and not(pe.imports('api-ms-win-core-timezone-l1-1-0.dll', 'SystemTimeToTzSpecificLocalTime'))) and (pe.imports('kernel32.dll', 'FindNextFileA') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'FindNextFileA') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'FindNextFileA')))} drvnskm_rule rule_cluster_6{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('user32.dll', 'DispatchMessageA')) and (pe.imports('kernel32.dll', 'FindNextFileA') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'FindNextFileA') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'FindNextFileA')) and (not(pe.imports('shell32.dll', 'SHFileOperationA'))))} drvnskm_rule rule_cluster_7{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'DispatchMessageA'))) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (pe.imports('kernel32.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'InitializeCriticalSection') or pe.imports('rtmpal.dll', 'InitializeCriticalSection')) and (pe.imports('kernel32.dll', 'DecodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer') or pe.imports('rtmpal.dll', 'DecodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer') or pe.imports('kernelbase.dll', 'DecodePointer')) and (pe.imports('advapi32.dll', 'RegEnumValueA') or pe.imports('api-ms-win-core-registry-l1-1-0.dll', 'RegEnumValueA') or pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'RegEnumValueA') or pe.imports('kernel32.dll', 'RegEnumValueA')))} drvnskm_rule rule_cluster_7{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'DispatchMessageA'))) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (pe.imports('kernel32.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'InitializeCriticalSection') or pe.imports('rtmpal.dll', 'InitializeCriticalSection')) and (pe.imports('kernel32.dll', 'DecodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer') or pe.imports('rtmpal.dll', 'DecodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer') or pe.imports('kernelbase.dll', 'DecodePointer')) and (pe.imports('advapi32.dll', 'RegEnumValueA') or pe.imports('api-ms-win-core-registry-l1-1-0.dll', 'RegEnumValueA') or pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'RegEnumValueA') or pe.imports('kernel32.dll', 'RegEnumValueA'))) or ((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'DispatchMessageA'))) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject')) and (pe.imports('kernel32.dll', 'InterlockedFlushSList') or pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedFlushSList') or pe.imports('api-ms-win-core-interlocked-l1-1-0.dll', 'InterlockedFlushSList')) and (not(pe.imports('kernel32.dll', 'SystemTimeToTzSpecificLocalTime')) and not(pe.imports('api-ms-win-core-timezone-l1-1-0.dll', 'SystemTimeToTzSpecificLocalTime'))) and (not(pe.imports('kernel32.dll', 'FindNextFileA')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'FindNextFileA')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'FindNextFileA'))))} drvnskm_rule rule_cluster_7{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'DispatchMessageA'))) and (not(pe.imports('kernel32.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject')) and not(pe.imports('rtmpal.dll', 'WaitForSingleObject')) and not(pe.imports('kernelbase.dll', 'WaitForSingleObject'))) and (pe.imports('kernel32.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'InitializeCriticalSection') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'InitializeCriticalSection') or pe.imports('rtmpal.dll', 'InitializeCriticalSection')) and (pe.imports('kernel32.dll', 'DecodePointer') or pe.imports('api-ms-win-core-util-l1-1-0.dll', 'DecodePointer') or pe.imports('rtmpal.dll', 'DecodePointer') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'DecodePointer') or pe.imports('kernelbase.dll', 'DecodePointer')) and (pe.imports('advapi32.dll', 'RegEnumValueA') or pe.imports('api-ms-win-core-registry-l1-1-0.dll', 'RegEnumValueA') or pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'RegEnumValueA') or pe.imports('kernel32.dll', 'RegEnumValueA'))) or ((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'DispatchMessageA'))) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject')) and (pe.imports('kernel32.dll', 'InterlockedFlushSList') or pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedFlushSList') or pe.imports('api-ms-win-core-interlocked-l1-1-0.dll', 'InterlockedFlushSList')) and (not(pe.imports('kernel32.dll', 'SystemTimeToTzSpecificLocalTime')) and not(pe.imports('api-ms-win-core-timezone-l1-1-0.dll', 'SystemTimeToTzSpecificLocalTime'))) and (not(pe.imports('kernel32.dll', 'FindNextFileA')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'FindNextFileA')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'FindNextFileA')))) or ((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'DispatchMessageA'))) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject')) and (pe.imports('kernel32.dll', 'InterlockedFlushSList') or pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedFlushSList') or pe.imports('api-ms-win-core-interlocked-l1-1-0.dll', 'InterlockedFlushSList')) and (pe.imports('kernel32.dll', 'SystemTimeToTzSpecificLocalTime') or pe.imports('api-ms-win-core-timezone-l1-1-0.dll', 'SystemTimeToTzSpecificLocalTime')))} drvnskm_rule rule_cluster_8{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('msvcrt.dll', '_initterm')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', '_initterm')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', '_initterm')) and not(pe.imports('msvcr120_clr0400.dll', '_initterm')) and not(pe.imports('msvcr100.dll', '_initterm')) and not(pe.imports('msvcr120.dll', '_initterm')) and not(pe.imports('msvcr90.dll', '_initterm')) and not(pe.imports('msvcr80.dll', '_initterm')) and not(pe.imports('msvcrt40.dll', '_initterm'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'GetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'GetLastError')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetLastError')) and not(pe.imports('rtmpal.dll', 'GetLastError')) and not(pe.imports('kernelbase.dll', 'GetLastError'))) and (pe.imports('kernel32.dll', 'VirtualProtect') or pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'VirtualProtect') or pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'VirtualProtect') or pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'VirtualProtect') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'VirtualProtect') or pe.imports('rtmpal.dll', 'VirtualProtect')) and (not(pe.imports('user32.dll', 'GetActiveWindow')) and not(pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'GetActiveWindow'))))} drvnskm_rule rule_cluster_9{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('msvcrt.dll', '_initterm')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', '_initterm')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', '_initterm')) and not(pe.imports('msvcr120_clr0400.dll', '_initterm')) and not(pe.imports('msvcr100.dll', '_initterm')) and not(pe.imports('msvcr120.dll', '_initterm')) and not(pe.imports('msvcr90.dll', '_initterm')) and not(pe.imports('msvcr80.dll', '_initterm')) and not(pe.imports('msvcrt40.dll', '_initterm'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'GetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'GetLastError') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetLastError') or pe.imports('rtmpal.dll', 'GetLastError') or pe.imports('kernelbase.dll', 'GetLastError')) and (not(pe.imports('kernel32.dll', 'MultiByteToWideChar')) and not(pe.imports('api-ms-win-core-string-l1-1-0.dll', 'MultiByteToWideChar')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'MultiByteToWideChar')) and not(pe.imports('rtmpal.dll', 'MultiByteToWideChar')) and not(pe.imports('kernelbase.dll', 'MultiByteToWideChar'))) and (not(pe.imports('winspool.drv', 'SetPrinterDataA'))))} drvnskm_rule rule_cluster_10{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('msvcrt.dll', '_initterm')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', '_initterm')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', '_initterm')) and not(pe.imports('msvcr120_clr0400.dll', '_initterm')) and not(pe.imports('msvcr100.dll', '_initterm')) and not(pe.imports('msvcr120.dll', '_initterm')) and not(pe.imports('msvcr90.dll', '_initterm')) and not(pe.imports('msvcr80.dll', '_initterm')) and not(pe.imports('msvcrt40.dll', '_initterm'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (not(pe.imports('kernel32.dll', 'GetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'GetLastError')) and not(pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'GetLastError')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetLastError')) and not(pe.imports('rtmpal.dll', 'GetLastError')) and not(pe.imports('kernelbase.dll', 'GetLastError'))) and (pe.imports('kernel32.dll', 'VirtualProtect') or pe.imports('api-ms-win-core-memory-l1-1-2.dll', 'VirtualProtect') or pe.imports('api-ms-win-core-memory-l1-1-0.dll', 'VirtualProtect') or pe.imports('api-ms-win-core-memory-l1-1-1.dll', 'VirtualProtect') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'VirtualProtect') or pe.imports('rtmpal.dll', 'VirtualProtect')) and (pe.imports('user32.dll', 'GetActiveWindow') or pe.imports('api-ms-win-rtcore-ntuser-window-l1-1-0.dll', 'GetActiveWindow')))} drvnskm_rule rule_cluster_12{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('msvcrt.dll', '_initterm')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', '_initterm')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', '_initterm')) and not(pe.imports('msvcr120_clr0400.dll', '_initterm')) and not(pe.imports('msvcr100.dll', '_initterm')) and not(pe.imports('msvcr120.dll', '_initterm')) and not(pe.imports('msvcr90.dll', '_initterm')) and not(pe.imports('msvcr80.dll', '_initterm')) and not(pe.imports('msvcrt40.dll', '_initterm'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'GetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'GetLastError') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetLastError') or pe.imports('rtmpal.dll', 'GetLastError') or pe.imports('kernelbase.dll', 'GetLastError')) and (pe.imports('kernel32.dll', 'MultiByteToWideChar') or pe.imports('api-ms-win-core-string-l1-1-0.dll', 'MultiByteToWideChar') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'MultiByteToWideChar') or pe.imports('rtmpal.dll', 'MultiByteToWideChar') or pe.imports('kernelbase.dll', 'MultiByteToWideChar')) and (pe.imports('user32.dll', 'IsIconic')))} drvnskm_rule rule_cluster_12{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('msvcrt.dll', '_initterm')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', '_initterm')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', '_initterm')) and not(pe.imports('msvcr120_clr0400.dll', '_initterm')) and not(pe.imports('msvcr100.dll', '_initterm')) and not(pe.imports('msvcr120.dll', '_initterm')) and not(pe.imports('msvcr90.dll', '_initterm')) and not(pe.imports('msvcr80.dll', '_initterm')) and not(pe.imports('msvcrt40.dll', '_initterm'))) and (pe.imports('kernel32.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress') or pe.imports('kernel32', 'GetProcAddress') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress') or pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress') or pe.imports('rtmpal.dll', 'GetProcAddress') or pe.imports('kernelbase.dll', 'GetProcAddress')) and (pe.imports('kernel32.dll', 'GetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-1.dll', 'GetLastError') or pe.imports('api-ms-win-core-errorhandling-l1-1-0.dll', 'GetLastError') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetLastError') or pe.imports('rtmpal.dll', 'GetLastError') or pe.imports('kernelbase.dll', 'GetLastError')) and (pe.imports('kernel32.dll', 'MultiByteToWideChar') or pe.imports('api-ms-win-core-string-l1-1-0.dll', 'MultiByteToWideChar') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'MultiByteToWideChar') or pe.imports('rtmpal.dll', 'MultiByteToWideChar') or pe.imports('kernelbase.dll', 'MultiByteToWideChar')) and (pe.imports('user32.dll', 'IsIconic'))) or ((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('user32.dll', 'DispatchMessageA')) and (not(pe.imports('kernel32.dll', 'FindNextFileA')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'FindNextFileA')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'FindNextFileA'))) and (pe.imports('user32.dll', 'GetMenuState')))} drvnskm_rule rule_cluster_13{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('user32.dll', 'DispatchMessageA')) and (pe.imports('kernel32.dll', 'FindNextFileA') or pe.imports('api-ms-win-core-file-l1-2-1.dll', 'FindNextFileA') or pe.imports('api-ms-win-core-file-l1-1-0.dll', 'FindNextFileA')) and (pe.imports('shell32.dll', 'SHFileOperationA')))} drvnskm_rule rule_cluster_14{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('msvcrt.dll', '_initterm')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', '_initterm')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', '_initterm')) and not(pe.imports('msvcr120_clr0400.dll', '_initterm')) and not(pe.imports('msvcr100.dll', '_initterm')) and not(pe.imports('msvcr120.dll', '_initterm')) and not(pe.imports('msvcr90.dll', '_initterm')) and not(pe.imports('msvcr80.dll', '_initterm')) and not(pe.imports('msvcrt40.dll', '_initterm'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (pe.imports('advapi32.dll', 'GetSidIdentifierAuthority') or pe.imports('api-ms-win-security-base-l1-2-0.dll', 'GetSidIdentifierAuthority') or pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'GetSidIdentifierAuthority')) and (pe.imports('crypt32.dll', 'CertStrToNameA')))} drvnskm_rule rule_cluster_14{condition:((not(pe.imports('kernel32.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA')) and not(pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA'))) and (not(pe.imports('msvcrt.dll', '_initterm')) and not(pe.imports('api-ms-win-crt-runtime-l1-1-0.dll', '_initterm')) and not(pe.imports('api-ms-win-core-crt-l2-1-0.dll', '_initterm')) and not(pe.imports('msvcr120_clr0400.dll', '_initterm')) and not(pe.imports('msvcr100.dll', '_initterm')) and not(pe.imports('msvcr120.dll', '_initterm')) and not(pe.imports('msvcr90.dll', '_initterm')) and not(pe.imports('msvcr80.dll', '_initterm')) and not(pe.imports('msvcrt40.dll', '_initterm'))) and (not(pe.imports('kernel32.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-2-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('kernel32', 'GetProcAddress')) and not(pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'GetProcAddress')) and not(pe.imports('api-ms-win-core-libraryloader-l1-1-1.dll', 'GetProcAddress')) and not(pe.imports('rtmpal.dll', 'GetProcAddress')) and not(pe.imports('kernelbase.dll', 'GetProcAddress'))) and (pe.imports('advapi32.dll', 'GetSidIdentifierAuthority') or pe.imports('api-ms-win-security-base-l1-2-0.dll', 'GetSidIdentifierAuthority') or pe.imports('api-ms-win-downlevel-advapi32-l1-1-0.dll', 'GetSidIdentifierAuthority')) and (pe.imports('crypt32.dll', 'CertStrToNameA'))) or ((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (not(pe.imports('user32.dll', 'DispatchMessageA'))) and (pe.imports('kernel32.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-2-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-core-synch-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('api-ms-win-downlevel-kernel32-l1-1-0.dll', 'WaitForSingleObject') or pe.imports('rtmpal.dll', 'WaitForSingleObject') or pe.imports('kernelbase.dll', 'WaitForSingleObject')) and (not(pe.imports('kernel32.dll', 'InterlockedFlushSList')) and not(pe.imports('api-ms-win-core-interlocked-l1-2-0.dll', 'InterlockedFlushSList')) and not(pe.imports('api-ms-win-core-interlocked-l1-1-0.dll', 'InterlockedFlushSList'))) and (pe.imports('msvcrt.dll', '__p__environ')))} drvnskm_rule rule_cluster_15{condition:((pe.imports('kernel32.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-2-0.dll', 'GetCommandLineA') or pe.imports('api-ms-win-core-processenvironment-l1-1-0.dll', 'GetCommandLineA')) and (pe.imports('user32.dll', 'DispatchMessageA')) and (not(pe.imports('kernel32.dll', 'FindNextFileA')) and not(pe.imports('api-ms-win-core-file-l1-2-1.dll', 'FindNextFileA')) and not(pe.imports('api-ms-win-core-file-l1-1-0.dll', 'FindNextFileA'))) and (not(pe.imports('user32.dll', 'GetMenuState'))))}